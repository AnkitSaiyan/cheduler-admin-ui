<div class="d-flex flex-column h-100 position-relative dfm-gap-16 dfm-px-8 ex-li-main-wrapper">
  <section>
    <div class="d-flex align-items-center dfm-gap-16 flex-1 ex-li-section-1">
      <dfm-button
        class="hidden ex-li-title-buttons"
        color="link"
        size="lg"
        routerLink="./"
      >Exam
      </dfm-button>

      <dfm-input
        class="flex-1 ex-li-search"
        size="md"
        placeholder="Search by Exam Name"
        icon="search-sm"
        [formControl]="searchControl"
      ></dfm-input>

      <div class="d-flex align-items-center dfm-button-group-wrapper ex-li-button-dropdown-group">
        <div class="dfm-button-icon-bg-transparent" [cdkCopyToClipboard]="clipboardData">
          <dfm-button-icon
            (click)="copyToClipboard()"
            color="tertiary-gray"
            size="md"
            icon="copy-03"
          ></dfm-button-icon>
        </div>

        <div class="dfm-dropdown-placeholder-text-primary dfm-dropdown-bg-transparent">
          <dfm-input-dropdown
            [items]="downloadItems"
            [showDescription]="false"
            [formControl]="downloadDropdownControl"
            placeholder="Download"
            size="md"
          ></dfm-input-dropdown>
        </div>
      </div>

      <div class="d-flex dfm-gap-8 align-items-center">
        <dfm-button
          color="primary"
          size="md"
          class="text-nowrap"
          [disabled]="false"
          routerLink="./add"
        >Add Exam
        </dfm-button>
      </div>
    </div>
  </section>

  <dfm-input
    size="md"
    placeholder="Search by Exam Name"
    icon="search-sm"
    class="w-full hidden ex-li-search-mv"
    [formControl]="searchControl"
  ></dfm-input>

  <section #tableWrapper class="overflow-y-auto ex-li-table-wrapper dfm-pb-8" *ngIf="filteredExams$$ | async as exams">
    <dfm-table [items]="exams" [selectable]="true" (selected)="handleCheckboxSelection($event)"
               [clearSelected$]="clearSelected$$" [rowClickable]="true" (rowClicked)="navigateToViewExam($event)"
               class="dfm-table-wrapper">
      <ng-template #headerRowTemplate>
        <dfm-table-header-cell *ngFor="let column of columns">{{ column }}</dfm-table-header-cell>
      </ng-template>

      <ng-template #bodyRowTemplate let-item>
        <dfm-table-body-cell>{{ item.name | titlecase | dashIfNothing }}</dfm-table-body-cell>
        <dfm-table-body-cell>{{ item.expensive | dashIfNothing }}</dfm-table-body-cell>

        <dfm-table-body-cell>
          <dfm-badge *ngIf="item.status === statusType.Active"
                     color="success"
                     size="sm"
                     fontWeight="medium">
            {{ item.status | statusName | dashIfNothing }}
          </dfm-badge>

          <dfm-badge *ngIf="item.status === statusType.Inactive"
                     color="primary"
                     size="sm">
            {{ item.status | statusName | dashIfNothing }}
          </dfm-badge>
        </dfm-table-body-cell>

        <dfm-table-body-cell>
          <div class="d-flex dfm-gap-16 align-items-center ex-li-action-buttons">
            <dfm-button
              *ngIf="item.status === statusType.Inactive"
              color="link-gray"
              size="sm"
              trailingIcon="check-circle"
              (click)="$event.stopPropagation(); changeStatus([ { id: item.id, status: statusType.Active }])"
            ></dfm-button>

            <dfm-button
              *ngIf="item.status === statusType.Active"
              color="link-gray"
              size="sm"
              trailingIcon="x-circle"
              (click)="$event.stopPropagation(); changeStatus([ { id: item.id, status: statusType.Inactive }])"
            ></dfm-button>

            <dfm-button
              color="link-gray"
              size="sm"
              trailingIcon="pencil-02"
              (click)="$event.stopPropagation();"
              [routerLink]="['./', item.id, 'edit']"
              [state]="{ comingFromRoute: 'exam', edit: true }"
            ></dfm-button>

            <dfm-button
              color="link-gray"
              size="sm"
              trailingIcon="trash-01"
              (click)="$event.stopPropagation(); deleteExam(item.id)"
            ></dfm-button>
          </div>

          <div class="position-relative">
            <div ngbDropdown #actionButtonsMenu="ngbDropdown">
              <div class="shadow-lg ex-li-action-buttons-menu ex-li-menus" ngbDropdownMenu
                   aria-labelledby="dropdownManual">
                <div ngbDropdownItem *ngIf="item.status === statusType.Inactive"
                     (click)="$event.stopPropagation(); changeStatus([ { id: item.id, status: statusType.Active }])">
                  <dfm-button trailingIcon="check-circle" color="link-gray"></dfm-button>
                </div>
                <div ngbDropdownItem *ngIf="item.status === statusType.Active"
                     (click)="$event.stopPropagation(); changeStatus([ { id: item.id, status: statusType.Inactive }])">
                  <dfm-button trailingIcon="x-circle" color="link-gray"></dfm-button>
                </div>
                <div ngbDropdownItem (click)="$event.stopPropagation()" [routerLink]="['./', item.id, 'edit']"
                     [state]="{ comingFromRoute: 'exam', edit: true }"
                     class="position-relative">
                  <dfm-button trailingIcon="pencil-02" color="link-gray"></dfm-button>
                  <div class="menu-point-forward shadow-sm"></div>
                </div>
                <div ngbDropdownItem (click)="$event.stopPropagation(); deleteExam(item.id)">
                  <dfm-button trailingIcon="trash-01" color="link-gray"></dfm-button>
                </div>
              </div>
            </div>

            <dfm-button
              class="hidden ex-li-vertical-dots-btn"
              color="link-gray"
              size="sm"
              trailingIcon="dots-vertical"
              (click)="$event.stopPropagation(); actionButtonsMenu.open();"
            ></dfm-button>

          </div>
        </dfm-table-body-cell>
      </ng-template>
    </dfm-table>
    <div class="d-flex justify-content-center dfm-p-16 dfm-mx-2 bg-white rounded-bottom" *ngIf="!exams.length">
      No data found
    </div>
  </section>
<!--  <div ngbDropdown #optionsMenu="ngbDropdown">-->
<!--    <div class="shadow-lg ex-li-plus-btn-menu ex-li-menus" ngbDropdownMenu aria-labelledby="dropdownManual">-->
<!--      <div ngbDropdownItem (click)="$event.stopPropagation(); openSearchModal()">-->
<!--        <dfm-button trailingIcon="search-sm" color="link-gray"></dfm-button>-->
<!--      </div>-->
<!--      <div ngbDropdownItem (click)="$event.stopPropagation(); toggleMenu()">-->
<!--        <dfm-button trailingIcon="copy-03" color="link-gray"></dfm-button>-->
<!--      </div>-->
<!--      <div ngbDropdownItem (click)="$event.stopPropagation(); toggleMenu()">-->
<!--        <dfm-button trailingIcon="download-01" color="link-gray"></dfm-button>-->
<!--      </div>-->
<!--    </div>-->
<!--  </div>-->

<!--  <dfm-button color="secondary" size="md" class="hidden shadow-lg ex-li-plus-btn rounded-2"-->
<!--              (click)="$event.stopPropagation(); optionsMenu.open(); toggleMenu()">-->
<!--    <dfm-icon #showMoreButtonIcon name="plus" class="ex-li-plus-btn-icon rotate-z-0 position-absolute"></dfm-icon>-->
<!--  </dfm-button>-->
</div>

<dfm-confirm-status-change-banner [display]="selectedExamIDs.length"
                                  (confirmationEvent)="handleConfirmation($event)"></dfm-confirm-status-change-banner>
