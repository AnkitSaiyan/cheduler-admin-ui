<div class="d-flex flex-column dfm-gap-16 ad-ap-main-wrapper" *ngIf="appointment$$ | async as smData">
  <section>
    <div class="d-flex align-items-center justify-content-between dfm-gap-16 ad-ap-title-buttons">
      <dfm-button
        color="link"
        size="lg"
        routerLink="./"
      >Appointment
      </dfm-button>

      <div class="d-flex dfm-gap-16 align-items-center">
        <dfm-button color="secondary" size="md">Cancel</dfm-button>
        <dfm-button color="primary" size="md"
                    (click)="saveAppointment()"> {{ appointment$$.value.id ? 'Save Changes' : 'Add Appointment' }} </dfm-button>
      </div>
    </div>

    <!--  Mobile view  -->
    <div class="hidden dfm-gap-8 align-items-center ad-ap-title-buttons-mv">
      <div class="rounded-circle overflow-hidden">
        <dfm-button-icon
          color="tertiary-gray"
          size="sm"
          icon="chevron-left"
        >
        </dfm-button-icon>
      </div>

      <dfm-button color="link" size="lg">Appointment</dfm-button>
    </div>
    <!--    -->
  </section>

  <section class="dfm-card dfm-p-16 ad-ap-section2 hide-scrollbar">
    <form [formGroup]="appointmentForm" class="d-flex flex-column dfm-gap-24 dfm-mb-16">
      <div class="d-flex dfm-gap-32 align-items-center">
        <dfm-input class="flex-1" size="md" placeholder="Enter first name" label="Patient First Name *"
                   formControlName="firstname">
        </dfm-input>

        <dfm-input class="flex-1" size="md" placeholder="Enter last name" label="Patient Last Name *"
                   formControlName="lastname">
        </dfm-input>

        <dfm-input class="flex-1" size="md" placeholder="Enter Telephone" label="Enter telephone *" type="number"
                   formControlName="telephone">
        </dfm-input>
      </div>

      <div class="d-flex dfm-gap-32 align-items-center flex-wrap">
        <dfm-input class="flex-1 min-w-128" size="md" placeholder="Enter Patient Email" label="Patient Email *"
                   formControlName="email">
        </dfm-input>

        <div class="dfm-input-dropdown-wrapper flex-1 w-full min-w-128">
          <dfm-input-dropdown [items]="physicianList" class="flex-1" size="md" placeholder="Select doctor" label="Doctor"
                              formControlName="doctor">
          </dfm-input-dropdown>
        </div>

        <div class="ad-ab-from-date flex-1 dfm-gap-8 w-full">
          <span class="text-sm font-weight-medium dfm-text-main-700">Date *</span>

          <div class="d-flex align-items-center dfm-gap-16 flex-1">
            <div class="dfm-button-group-wrapper h-fit flex-1">
              <div class="input-as-dfm-input flex-1">
                <input
                  class="w-full min-w-128"
                  formControlName="date"
                  placeholder="yyyy-mm-dd"
                  ngbDatepicker
                  #date="ngbDatepicker"
                />
              </div>
              <div>
                <dfm-button-icon
                  color="tertiary-gray"
                  size="md"
                  icon="calendar-date"
                  (click)="date.toggle()"
                ></dfm-button-icon>
              </div>
            </div>

            <div class="dfm-input-dropdown-wrapper-wo-label flex-1 min-w-128 max-w-192">
              <dfm-input-dropdown #time
                                  [items]="timings"
                                  [typeToSearch]="true"
                                  [typeToSearchText]="time.value"
                                  (searchInput)="handleTimeInput($event)"
                                  formControlName="time"
                                  size="md"
                                  placeholder="hh:mm">
              </dfm-input-dropdown>
            </div>
          </div>
        </div>
      </div>

      <div class="d-flex flex-column dfm-gap-16 flex-1">
        <span class="text-sm font-weight-medium dfm-text-main-700 text-nowrap">Room Type *</span>
        <div class="w-fit d-flex justify-content-between dfm-gap-24">
          <dfm-radio-button class="font-weight-normal" label="Public" [checkedValue]="roomType.Public"
                            formControlName="roomType"></dfm-radio-button>
          <dfm-radio-button class="font-weight-normal" label="Private" [checkedValue]="roomType.Private"
                            formControlName="roomType"></dfm-radio-button>
        </div>
      </div>

      <div class="dfm-input-multi-dropdown-wrapper ad-ap-multi-dropdown">
        <dfm-input-dropdown #rooms
                            [items]="formValues.roomType ? roomList[formValues.roomType] : []"
                            [multiple]="true"
                            [placeholder]="!!rooms.value?.length ? rooms.value.length + ' Selected' : 'Select Rooms'"
                            formControlName="roomList"
                            size="md"
                            label="Rooms *">
        </dfm-input-dropdown>
      </div>

      <div class="dfm-input-multi-dropdown-wrapper ad-ap-multi-dropdown">
        <dfm-input-dropdown #exams
                            [items]="examList"
                            [multiple]="true"
                            [placeholder]="!!exams.value?.length ? exams.value.length + ' Selected' : 'Select Exams'"
                            formControlName="examList"
                            size="md"
                            label="Exams *">
        </dfm-input-dropdown>
      </div>

      <div class="dfm-input-multi-dropdown-wrapper ad-ap-multi-dropdown">
        <dfm-input-dropdown #staffs
                            [items]="userList"
                            [multiple]="true"
                            [placeholder]="!!staffs.value?.length ? staffs.value.length + ' Selected' : 'Select General Users'"
                            formControlName="userList"
                            size="md"
                            label="General Users *">
        </dfm-input-dropdown>
      </div>

      <dfm-text-area label="Comments / Clinical data" placeholder="Enter comments"
                     formControlName="comments"></dfm-text-area>

      <dfm-button class="hidden ad-ap-save-changes-btn-mv" color="primary" size="md" (click)="saveAppointment()">Save
        Changes
      </dfm-button>
    </form>
  </section>

</div>
