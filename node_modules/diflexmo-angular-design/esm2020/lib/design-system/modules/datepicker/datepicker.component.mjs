import { Component, EventEmitter, Input, Output } from '@angular/core';
import { FormControl, FormGroup } from '@angular/forms';
import { Day } from './models/day';
import { weekCount } from './utils';
import { Week } from './models/week';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
import * as i2 from "../input/input.component";
import * as i3 from "../button/components/button/button.component";
import * as i4 from "@angular/forms";
import * as i5 from "../icon/components/icon/icon.component";
export class DatepickerComponent {
    constructor() {
        this.datesApplied = new EventEmitter();
        this.cancelled = new EventEmitter();
        this.dateRange = new FormGroup({
            startDate: new FormControl(null),
            endDate: new FormControl(null),
        });
        this.weekNames = ['Mo', 'Tu', 'We', 'Th', 'Fr', 'Sat', 'Su'];
        this.firstMonthWeeks = [];
        this.secondMonthWeeks = [];
        this.firstMonth = new Date();
        this.secondMonth = new Date();
    }
    get firstSelectedDate() {
        return this.privateFirstSelectedDate;
    }
    set firstSelectedDate(value) {
        this.privateFirstSelectedDate = value;
        this.dateRange.controls['startDate'].setValue(value || null);
    }
    get secondSelectedDate() {
        return this.privateSecondSelectedDate;
    }
    set secondSelectedDate(value) {
        this.privateSecondSelectedDate = value;
        this.dateRange.controls['endDate'].setValue(value || null);
    }
    ngOnInit() {
        this.secondMonth.setMonth(new Date().getMonth() + 1);
        this.setWeeks();
    }
    setWeeks() {
        const month = this.firstMonth.getMonth();
        const year = this.firstMonth.getFullYear();
        const daysInFirstMonth = new Date(year, month, 0).getDate();
        const secondMonth = this.secondMonth.getMonth();
        const secondYear = this.secondMonth.getFullYear();
        const daysInSecondMonth = new Date(year, month, 0).getDate();
        let firstDay = 0;
        let monthRows = 0;
        if (daysInFirstMonth >= daysInSecondMonth) {
            firstDay = DatepickerComponent.getFirstDayOfMonthIndex(month, year);
            monthRows = Math.ceil((daysInFirstMonth + firstDay) / 7);
        }
        else {
            firstDay = DatepickerComponent.getFirstDayOfMonthIndex(secondMonth, secondYear);
            monthRows = Math.ceil((daysInSecondMonth + firstDay) / 7);
        }
        const weeks = weekCount(year, month);
        const weeksSecondMonth = weekCount(secondYear, secondMonth);
        if (weeks > weeksSecondMonth) {
            monthRows = weeks;
        }
        else {
            monthRows = weeksSecondMonth;
        }
        let dayInMonth = 1;
        let dayInSecondMonth = 1;
        const firstDate = new Date(year, month, 1);
        const firstDateSecondMonth = new Date(year, secondMonth, 1);
        this.firstMonthWeeks = [];
        this.secondMonthWeeks = [];
        for (let i = 0; i < monthRows; i += 1) {
            const days = [];
            const secondMonthDays = [];
            for (let j = 0; j < 7; j += 1) {
                if (i === 0) {
                    if (j < firstDate.getDay() - 1) {
                        const day = new Date(year, month, 0);
                        const dayNumber = day.getDate() - (firstDate.getDay() - 2 - j);
                        day.setDate(dayNumber);
                        days.push(new Day(day));
                    }
                    else {
                        const date = new Date(year, month, dayInMonth);
                        const isCurrentMonth = date.getMonth() === month;
                        days.push(new Day(date, isCurrentMonth));
                        dayInMonth += 1;
                    }
                    if (j < firstDateSecondMonth.getDay() - 1) {
                        const day2 = new Date(secondYear, secondMonth, 0);
                        const day2Number = day2.getDate() - (firstDateSecondMonth.getDay() - 2 - j);
                        day2.setDate(day2Number);
                        secondMonthDays.push(new Day(day2));
                    }
                    else {
                        secondMonthDays.push(new Day(new Date(secondYear, secondMonth, dayInSecondMonth), true));
                        dayInSecondMonth += 1;
                    }
                }
                else {
                    const date = new Date(year, month, dayInMonth);
                    const isCurrentMonth = date.getMonth() === month;
                    days.push(new Day(date, isCurrentMonth));
                    dayInMonth += 1;
                    const date2 = new Date(secondYear, secondMonth, dayInSecondMonth);
                    const isCurrentMonth2 = date2.getMonth() === secondMonth;
                    secondMonthDays.push(new Day(date2, isCurrentMonth2));
                    dayInSecondMonth += 1;
                }
            }
            const week = new Week(days);
            const week2 = new Week(secondMonthDays);
            this.firstMonthWeeks.push(week);
            this.secondMonthWeeks.push(week2);
        }
    }
    static getFirstDayOfMonthIndex(month, year) {
        const day = new Date();
        day.setDate(1);
        day.setMonth(month);
        day.setFullYear(year);
        const dayIndex = day.getDay() + 7;
        return dayIndex >= 7 ? dayIndex - 7 : dayIndex;
    }
    isSelectedDate(date) {
        return this.firstSelectedDate?.getTime() === date.getTime() || this.secondSelectedDate?.getTime() === date.getTime();
    }
    isBetweenSelection(date) {
        if (!this.firstSelectedDate || !this.secondSelectedDate || !date) {
            return false;
        }
        return this.firstSelectedDate < date && this.secondSelectedDate > date;
    }
    selectDate(date) {
        if (!date) {
            return;
        }
        if (this.secondSelectedDate && date === this.secondSelectedDate) {
            this.secondSelectedDate = undefined;
            return;
        }
        if (this.firstSelectedDate && this.firstSelectedDate === date) {
            this.firstSelectedDate = undefined;
            if (this.secondSelectedDate) {
                this.firstSelectedDate = this.secondSelectedDate;
                this.secondSelectedDate = undefined;
            }
            return;
        }
        if (!this.firstSelectedDate) {
            this.firstSelectedDate = date;
        }
        if (this.firstSelectedDate > date) {
            if (!this.secondSelectedDate) {
                this.secondSelectedDate = this.firstSelectedDate;
            }
            this.firstSelectedDate = date;
        }
        if (date > this.firstSelectedDate) {
            this.secondSelectedDate = date;
        }
    }
    cancel() {
        this.cancelled.next(true);
    }
    today() {
        const date = new Date();
        date.setHours(0, 0, 0, 0);
        this.firstSelectedDate = date;
        this.secondSelectedDate = date;
        this.datesApplied.next({ startDate: date, stopDate: date });
    }
    yesterday() {
        const date = new Date();
        date.setHours(0, 0, 0, 0);
        date.setDate(date.getDate() - 1);
        this.firstSelectedDate = date;
        this.secondSelectedDate = date;
        this.datesApplied.next({ startDate: date, stopDate: date });
    }
    thisMonth() {
        const date = new Date();
        this.firstSelectedDate = new Date(date.getFullYear(), date.getMonth(), 1);
        this.secondSelectedDate = new Date(date.getFullYear(), date.getMonth() + 1, 0);
        this.datesApplied.next({ startDate: this.firstSelectedDate, stopDate: this.secondSelectedDate });
    }
    lastMonth() {
        const date = new Date();
        date.setMonth(date.getMonth() - 1);
        this.firstSelectedDate = new Date(date.getFullYear(), date.getMonth(), 1);
        this.secondSelectedDate = new Date(date.getFullYear(), date.getMonth() + 1, 0);
        this.datesApplied.next({ startDate: this.firstSelectedDate, stopDate: this.secondSelectedDate });
    }
    thisYear() {
        const date = new Date();
        this.firstSelectedDate = new Date(date.getFullYear(), 0, 1);
        this.secondSelectedDate = new Date(date.getFullYear() + 1, 0, 0);
        this.datesApplied.next({ startDate: this.firstSelectedDate, stopDate: this.secondSelectedDate });
    }
    lastYear() {
        const date = new Date();
        date.setFullYear(date.getFullYear() - 1);
        this.firstSelectedDate = new Date(date.getFullYear(), 0, 1);
        this.secondSelectedDate = new Date(date.getFullYear() + 1, 0, 0);
        this.datesApplied.next({ startDate: this.firstSelectedDate, stopDate: this.secondSelectedDate });
    }
    firstMonthPrevious() {
        this.firstMonth.setMonth(this.firstMonth.getMonth() - 1);
        this.firstMonth = new Date(this.firstMonth);
        this.setWeeks();
    }
    firstMonthNext() {
        this.firstMonth.setMonth(this.firstMonth.getMonth() + 1);
        this.firstMonth = new Date(this.firstMonth);
        if (this.firstMonth.getMonth() === this.secondMonth.getMonth()) {
            this.secondMonth.setMonth(this.secondMonth.getMonth() + 1);
            this.secondMonth = new Date(this.secondMonth);
        }
        this.setWeeks();
    }
    secondMonthPrevious() {
        this.secondMonth.setMonth(this.secondMonth.getMonth() - 1);
        this.secondMonth = new Date(this.secondMonth);
        if (this.firstMonth.getMonth() === this.secondMonth.getMonth()) {
            this.firstMonth.setMonth(this.firstMonth.getMonth() - 1);
            this.firstMonth = new Date(this.firstMonth);
        }
        this.setWeeks();
    }
    secondMonthNext() {
        this.secondMonth.setMonth(this.secondMonth.getMonth() + 1);
        this.secondMonth = new Date(this.secondMonth);
        this.setWeeks();
    }
    applyDates() {
        this.datesApplied.next({ startDate: this.firstSelectedDate, stopDate: this.secondSelectedDate });
    }
    startDateFocusOut() {
        const startDateControlValue = this.dateRange.controls['startDate'].value;
        if (this.isDate(startDateControlValue)) {
            if (this.secondSelectedDate && startDateControlValue > this.secondSelectedDate) {
                this.firstSelectedDate = this.secondSelectedDate;
                this.secondSelectedDate = startDateControlValue;
            }
            else {
                this.firstSelectedDate = startDateControlValue;
            }
        }
        else {
            this.firstSelectedDate = this.privateFirstSelectedDate;
        }
    }
    endDateFocusOut() {
        const endDateControlValue = this.dateRange.controls['endDate'].value;
        if (this.isDate(endDateControlValue)) {
            if (this.firstSelectedDate && endDateControlValue < this.firstSelectedDate) {
                this.secondSelectedDate = this.firstSelectedDate;
                this.firstSelectedDate = endDateControlValue;
            }
            else {
                this.secondSelectedDate = endDateControlValue;
            }
        }
        else {
            this.secondSelectedDate = this.privateFirstSelectedDate;
        }
    }
    isToday(month, date) {
        const today = new Date();
        return (month === date.getMonth() &&
            date.getDate() === today.getDate() &&
            date.getMonth() === today.getMonth() &&
            date.getFullYear() === today.getFullYear());
    }
    isDate(date) {
        return date instanceof Date && !Number.isNaN(date.getTime());
    }
}
DatepickerComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "14.2.12", ngImport: i0, type: DatepickerComponent, deps: [], target: i0.ɵɵFactoryTarget.Component });
DatepickerComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "14.2.12", type: DatepickerComponent, selector: "dfm-datepicker", inputs: { firstSelectedDate: "firstSelectedDate", secondSelectedDate: "secondSelectedDate" }, outputs: { datesApplied: "datesApplied", cancelled: "cancelled" }, ngImport: i0, template: "<div class=\"dfm-datepicker-container d-flex\">\n  <div class=\"default-date-options-container d-flex justify-content-center\">\n    <div class=\"default-date-options\">\n      <button class=\"btn btn-tertiary-gray\" (click)=\"today()\">Today</button>\n      <button class=\"btn btn-tertiary-gray\" (click)=\"yesterday()\">Yesterday</button>\n      <button class=\"btn btn-tertiary-gray\" (click)=\"thisMonth()\">This month</button>\n      <button class=\"btn btn-tertiary-gray\" (click)=\"lastMonth()\">Last month</button>\n      <button class=\"btn btn-tertiary-gray\" (click)=\"thisYear()\">This year</button>\n      <button class=\"btn btn-tertiary-gray\" (click)=\"lastYear()\">Last year</button>\n    </div>\n  </div>\n  <div class=\"datepicker d-flex flex-column\">\n    <div class=\"datepicker-months d-flex flex-wrap justify-content-center\">\n      <div class=\"datepicker-month datepicker-month-left\">\n        <div class=\"datepicker-month-header d-flex justify-content-between align-items-center\">\n          <dfm-icon name=\"chevron-left\" class=\"month-icon dfm-text-main-500\" (click)=\"firstMonthPrevious()\"></dfm-icon>\n          <div class=\"my-auto text-md-medium\">\n            {{ firstMonth | date: 'MMMM yyyy' }}\n          </div>\n          <dfm-icon name=\"chevron-right\" class=\"month-icon dfm-text-main-500\" (click)=\"firstMonthNext()\"></dfm-icon>\n        </div>\n        <ng-container *ngTemplateOutlet=\"monthView; context: { weeks: firstMonthWeeks }\"></ng-container>\n      </div>\n      <div class=\"datepicker-month\">\n        <div class=\"datepicker-month-header d-flex justify-content-between align-items-center\">\n          <dfm-icon name=\"chevron-left\" class=\"month-icon dfm-text-main-500\" (click)=\"secondMonthPrevious()\"></dfm-icon>\n          <div class=\"my-auto text-md-medium\">\n            {{ secondMonth | date: 'MMMM yyyy' }}\n          </div>\n          <dfm-icon name=\"chevron-right\" class=\"month-icon dfm-text-main-500\" (click)=\"secondMonthNext()\"></dfm-icon>\n        </div>\n        <ng-container *ngTemplateOutlet=\"monthView; context: { weeks: secondMonthWeeks }\"></ng-container>\n      </div>\n    </div>\n    <form [formGroup]=\"dateRange\">\n      <div class=\"actions-bar d-flex align-items-center\">\n        <div class=\"d-flex actions-bar-inputs\">\n          <div class=\"datepicker-input\">\n            <dfm-input formControlName=\"startDate\" type=\"datepicker\" placeholder=\"Start Date\" (focusout)=\"startDateFocusOut()\"></dfm-input>\n          </div>\n          <div class=\"text-center\">\n            <span class=\"datepicker-input-dash my-auto\">-</span>\n          </div>\n          <div class=\"datepicker-input\">\n            <dfm-input formControlName=\"endDate\" type=\"datepicker\" placeholder=\"End Date\" (focusout)=\"endDateFocusOut()\"></dfm-input>\n          </div>\n        </div>\n        <div class=\"d-flex actions-bar-buttons\">\n          <dfm-button color=\"secondary\" size=\"md\" (click)=\"cancel()\">Cancel</dfm-button>\n          <dfm-button size=\"md\" (click)=\"applyDates()\">Apply dates</dfm-button>\n        </div>\n      </div>\n    </form>\n  </div>\n</div>\n\n<ng-template #monthView let-weeks=\"weeks\">\n  <table>\n    <thead>\n      <tr>\n        <th *ngFor=\"let weekName of weekNames\">{{ weekName }}</th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr *ngFor=\"let week of weeks\">\n        <td\n          class=\"text-center\"\n          [ngClass]=\"{\n            'cell-wrapper-selected': isSelectedDate(day.date) && firstSelectedDate && secondSelectedDate,\n            'cell-wrapper-selected-first': firstSelectedDate && secondSelectedDate && firstSelectedDate.getTime() !== secondSelectedDate.getTime(),\n            'cell-wrapper-selected-second': firstSelectedDate && secondSelectedDate && firstSelectedDate.getTime() !== secondSelectedDate.getTime(),\n            'cell-wrapper-between-selection': isBetweenSelection(day.date),\n            'cell-wrapper-between-selection-right': isBetweenSelection(day.date) && i === 6,\n            'cell-wrapper-between-selection-left': isBetweenSelection(day.date) && i === 0\n          }\"\n          *ngFor=\"let day of week.days; index as i\"\n          (click)=\"selectDate(day.date)\"\n        >\n          <div\n            class=\"calendar-cell d-flex justify-content-center align-items-center\"\n            [ngClass]=\"{\n              'cell-selected': isSelectedDate(day.date),\n              'cell-between-selection': isBetweenSelection(day.date) && i !== 6 && i !== 0,\n              'cell-muted': !day.isCurrentMonth,\n              'cell-today': isToday(firstMonth.getMonth(), day.date)\n            }\"\n          >\n            {{ day.date.getDate() }}\n            <span *ngIf=\"isToday(firstMonth.getMonth(), day.date)\" class=\"cell-today-dot\"></span>\n          </div>\n        </td>\n      </tr>\n    </tbody>\n  </table>\n</ng-template>\n", styles: [".dfm-datepicker-container{font-family:Montserrat;font-style:normal;font-size:14px;line-height:20px;font-weight:400;border-radius:8px;border:1px solid var(--dfm-datepicker-border);box-shadow:0 16px 64px -12px #10182824;background-color:var(--dfm-datepicker-bg);flex-wrap:wrap;width:-moz-fit-content;width:fit-content}.dfm-datepicker-container .default-date-options-container{flex-grow:1;width:min-content;border-right:1px solid var(--dfm-datepicker-border)}.dfm-datepicker-container .default-date-options-container .default-date-options{padding:12px 16px;display:flex;align-items:flex-start;flex-wrap:wrap;height:min-content}.dfm-datepicker-container .default-date-options-container .default-date-options .btn.btn-tertiary-gray{padding:10px 16px;white-space:nowrap;color:var(--dfm-datepicker-default-date-options-color)}.dfm-datepicker-container .default-date-options-container .default-date-options .btn.btn-tertiary-gray:hover{background-color:var(--dfm-datepicker-default-date-options-bg-hover)}.dfm-datepicker-container .datepicker,.dfm-datepicker-container .datepicker-months{flex-grow:1}.dfm-datepicker-container .datepicker-months .datepicker-month{padding:26px 24px 20px}.dfm-datepicker-container .datepicker-months .datepicker-month.datepicker-month-left{border-right:1px solid var(--dfm-datepicker-border)}.dfm-datepicker-container .datepicker-months .datepicker-month th{font-weight:500;text-align:center;color:var(--dfm-datepicker-month-header-color)}.dfm-datepicker-container .datepicker-months .datepicker-month th,.dfm-datepicker-container .datepicker-months .datepicker-month td{overflow:hidden;width:42px;height:42px}.dfm-datepicker-container .datepicker-months .datepicker-month .datepicker-month-header{padding:6px 8px;margin-bottom:6px}.dfm-datepicker-container .datepicker-months .datepicker-month .datepicker-month-header .month-icon{width:20px;height:20px;cursor:pointer}.dfm-datepicker-container .datepicker-months .datepicker-month .calendar-cell{height:100%;color:var(--dfm-datepicker-cell-color)}.dfm-datepicker-container .datepicker-months .datepicker-month .calendar-cell:hover{font-weight:500;background:var(--dfm-datepicker-cell-bg-hover);color:var(--dfm-datepicker-cell-color-hover);border-radius:50%;cursor:pointer}.dfm-datepicker-container .datepicker-months .datepicker-month .cell-muted{color:var(--dfm-datepicker-cell-color-muted)}.dfm-datepicker-container .datepicker-months .datepicker-month .cell-wrapper-selected{background-color:var(--dfm-datepicker-cell-wrapper-bg-selected);border-radius:50%}.dfm-datepicker-container .datepicker-months .datepicker-month .cell-wrapper-selected-first{border-top-right-radius:0%;border-bottom-right-radius:0%}.dfm-datepicker-container .datepicker-months .datepicker-month .cell-wrapper-selected-second{border-top-left-radius:0%;border-bottom-left-radius:0%}.dfm-datepicker-container .datepicker-months .datepicker-month .cell-wrapper-between-selection{background-color:var(--dfm-datepicker-cell-wrapper-bg-selected);border-right-color:var(--dfm-datepicker-cell-wrapper-bg-selected);border-left-color:var(--dfm-datepicker-cell-wrapper-bg-selected)}.dfm-datepicker-container .datepicker-months .datepicker-month .cell-wrapper-between-selection-right{border-bottom-right-radius:50%;border-top-right-radius:50%}.dfm-datepicker-container .datepicker-months .datepicker-month .cell-wrapper-between-selection-left{border-bottom-left-radius:50%;border-top-left-radius:50%}.dfm-datepicker-container .datepicker-months .datepicker-month .cell-selected{font-weight:500;background:var(--dfm-datepicker-cell-bg-selected);color:var(--dfm-datepicker-cell-color-selected);border-radius:50%}.dfm-datepicker-container .datepicker-months .datepicker-month .cell-between-selection{position:relative;border-radius:0}.dfm-datepicker-container .datepicker-months .datepicker-month .datepicker-input{width:115px}.dfm-datepicker-container .datepicker-months .datepicker-month .cell-today:not(.cell-selected,.calendar-cell:hover,.cell-between-selection,.cell-between-selection-right,.cell-between-selection-left){background-color:var(--dfm-datepicker-cell-bg-today);border-radius:20px;position:relative}.dfm-datepicker-container .datepicker-months .datepicker-month .cell-today:not(.cell-selected,.calendar-cell:hover) .cell-today-dot{position:absolute;left:calc(50% - 2.5px);bottom:4px;width:5px;height:5px;border-radius:50%;background-color:var(--dfm-datepicker-cell-color-today)}.dfm-datepicker-container .actions-bar{border-top:1px solid var(--dfm-datepicker-border);padding:16px;justify-content:space-between;flex-wrap:wrap}.dfm-datepicker-container .actions-bar .actions-bar-inputs{gap:12px;align-items:center}.dfm-datepicker-container .actions-bar .actions-bar-inputs .datepicker-input{width:115px}.dfm-datepicker-container .actions-bar .actions-bar-inputs .datepicker-input-dash{font-style:normal;font-weight:400;font-size:16px;line-height:24px;color:var(--dfm-datepicker-inputs-dash-color)}.dfm-datepicker-container .actions-bar .actions-bar-buttons{gap:12px}@media (max-width: 960px){.dfm-datepicker-container .default-date-options-container{border-right:none;border-bottom:1px solid var(--dfm-datepicker-border)}.dfm-datepicker-container .default-date-options-container .default-date-options{flex-direction:row;flex-wrap:wrap;justify-content:center}.dfm-datepicker-container .datepicker-months .datepicker-month.datepicker-month-left{border-right:none}}@media (max-width: 680px){.dfm-datepicker-container .actions-bar{padding:0}.dfm-datepicker-container .actions-bar .actions-bar-inputs{width:100%;padding:16px}.dfm-datepicker-container .actions-bar .actions-bar-inputs .datepicker-input{flex:1}.dfm-datepicker-container .actions-bar .actions-bar-buttons{width:100%;flex-direction:column;padding:16px 16px 24px;border-top:1px solid var(--dfm-datepicker-border)}}\n"], dependencies: [{ kind: "directive", type: i1.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i1.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i1.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i1.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }, { kind: "component", type: i2.InputComponent, selector: "dfm-input", inputs: ["type", "size", "label", "placeholder", "disabled", "hint", "icon", "isInvalid", "readonly"] }, { kind: "component", type: i3.ButtonComponent, selector: "dfm-button", inputs: ["color", "size", "disabled", "leadingIcon", "trailingIcon"], outputs: ["clicked"] }, { kind: "directive", type: i4.ɵNgNoValidate, selector: "form:not([ngNoForm]):not([ngNativeValidate])" }, { kind: "directive", type: i4.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { kind: "directive", type: i4.NgControlStatusGroup, selector: "[formGroupName],[formArrayName],[ngModelGroup],[formGroup],form:not([ngNoForm]),[ngForm]" }, { kind: "directive", type: i4.FormGroupDirective, selector: "[formGroup]", inputs: ["formGroup"], outputs: ["ngSubmit"], exportAs: ["ngForm"] }, { kind: "directive", type: i4.FormControlName, selector: "[formControlName]", inputs: ["formControlName", "disabled", "ngModel"], outputs: ["ngModelChange"] }, { kind: "component", type: i5.IconComponent, selector: "dfm-icon", inputs: ["name"] }, { kind: "pipe", type: i1.DatePipe, name: "date" }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "14.2.12", ngImport: i0, type: DatepickerComponent, decorators: [{
            type: Component,
            args: [{ selector: 'dfm-datepicker', template: "<div class=\"dfm-datepicker-container d-flex\">\n  <div class=\"default-date-options-container d-flex justify-content-center\">\n    <div class=\"default-date-options\">\n      <button class=\"btn btn-tertiary-gray\" (click)=\"today()\">Today</button>\n      <button class=\"btn btn-tertiary-gray\" (click)=\"yesterday()\">Yesterday</button>\n      <button class=\"btn btn-tertiary-gray\" (click)=\"thisMonth()\">This month</button>\n      <button class=\"btn btn-tertiary-gray\" (click)=\"lastMonth()\">Last month</button>\n      <button class=\"btn btn-tertiary-gray\" (click)=\"thisYear()\">This year</button>\n      <button class=\"btn btn-tertiary-gray\" (click)=\"lastYear()\">Last year</button>\n    </div>\n  </div>\n  <div class=\"datepicker d-flex flex-column\">\n    <div class=\"datepicker-months d-flex flex-wrap justify-content-center\">\n      <div class=\"datepicker-month datepicker-month-left\">\n        <div class=\"datepicker-month-header d-flex justify-content-between align-items-center\">\n          <dfm-icon name=\"chevron-left\" class=\"month-icon dfm-text-main-500\" (click)=\"firstMonthPrevious()\"></dfm-icon>\n          <div class=\"my-auto text-md-medium\">\n            {{ firstMonth | date: 'MMMM yyyy' }}\n          </div>\n          <dfm-icon name=\"chevron-right\" class=\"month-icon dfm-text-main-500\" (click)=\"firstMonthNext()\"></dfm-icon>\n        </div>\n        <ng-container *ngTemplateOutlet=\"monthView; context: { weeks: firstMonthWeeks }\"></ng-container>\n      </div>\n      <div class=\"datepicker-month\">\n        <div class=\"datepicker-month-header d-flex justify-content-between align-items-center\">\n          <dfm-icon name=\"chevron-left\" class=\"month-icon dfm-text-main-500\" (click)=\"secondMonthPrevious()\"></dfm-icon>\n          <div class=\"my-auto text-md-medium\">\n            {{ secondMonth | date: 'MMMM yyyy' }}\n          </div>\n          <dfm-icon name=\"chevron-right\" class=\"month-icon dfm-text-main-500\" (click)=\"secondMonthNext()\"></dfm-icon>\n        </div>\n        <ng-container *ngTemplateOutlet=\"monthView; context: { weeks: secondMonthWeeks }\"></ng-container>\n      </div>\n    </div>\n    <form [formGroup]=\"dateRange\">\n      <div class=\"actions-bar d-flex align-items-center\">\n        <div class=\"d-flex actions-bar-inputs\">\n          <div class=\"datepicker-input\">\n            <dfm-input formControlName=\"startDate\" type=\"datepicker\" placeholder=\"Start Date\" (focusout)=\"startDateFocusOut()\"></dfm-input>\n          </div>\n          <div class=\"text-center\">\n            <span class=\"datepicker-input-dash my-auto\">-</span>\n          </div>\n          <div class=\"datepicker-input\">\n            <dfm-input formControlName=\"endDate\" type=\"datepicker\" placeholder=\"End Date\" (focusout)=\"endDateFocusOut()\"></dfm-input>\n          </div>\n        </div>\n        <div class=\"d-flex actions-bar-buttons\">\n          <dfm-button color=\"secondary\" size=\"md\" (click)=\"cancel()\">Cancel</dfm-button>\n          <dfm-button size=\"md\" (click)=\"applyDates()\">Apply dates</dfm-button>\n        </div>\n      </div>\n    </form>\n  </div>\n</div>\n\n<ng-template #monthView let-weeks=\"weeks\">\n  <table>\n    <thead>\n      <tr>\n        <th *ngFor=\"let weekName of weekNames\">{{ weekName }}</th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr *ngFor=\"let week of weeks\">\n        <td\n          class=\"text-center\"\n          [ngClass]=\"{\n            'cell-wrapper-selected': isSelectedDate(day.date) && firstSelectedDate && secondSelectedDate,\n            'cell-wrapper-selected-first': firstSelectedDate && secondSelectedDate && firstSelectedDate.getTime() !== secondSelectedDate.getTime(),\n            'cell-wrapper-selected-second': firstSelectedDate && secondSelectedDate && firstSelectedDate.getTime() !== secondSelectedDate.getTime(),\n            'cell-wrapper-between-selection': isBetweenSelection(day.date),\n            'cell-wrapper-between-selection-right': isBetweenSelection(day.date) && i === 6,\n            'cell-wrapper-between-selection-left': isBetweenSelection(day.date) && i === 0\n          }\"\n          *ngFor=\"let day of week.days; index as i\"\n          (click)=\"selectDate(day.date)\"\n        >\n          <div\n            class=\"calendar-cell d-flex justify-content-center align-items-center\"\n            [ngClass]=\"{\n              'cell-selected': isSelectedDate(day.date),\n              'cell-between-selection': isBetweenSelection(day.date) && i !== 6 && i !== 0,\n              'cell-muted': !day.isCurrentMonth,\n              'cell-today': isToday(firstMonth.getMonth(), day.date)\n            }\"\n          >\n            {{ day.date.getDate() }}\n            <span *ngIf=\"isToday(firstMonth.getMonth(), day.date)\" class=\"cell-today-dot\"></span>\n          </div>\n        </td>\n      </tr>\n    </tbody>\n  </table>\n</ng-template>\n", styles: [".dfm-datepicker-container{font-family:Montserrat;font-style:normal;font-size:14px;line-height:20px;font-weight:400;border-radius:8px;border:1px solid var(--dfm-datepicker-border);box-shadow:0 16px 64px -12px #10182824;background-color:var(--dfm-datepicker-bg);flex-wrap:wrap;width:-moz-fit-content;width:fit-content}.dfm-datepicker-container .default-date-options-container{flex-grow:1;width:min-content;border-right:1px solid var(--dfm-datepicker-border)}.dfm-datepicker-container .default-date-options-container .default-date-options{padding:12px 16px;display:flex;align-items:flex-start;flex-wrap:wrap;height:min-content}.dfm-datepicker-container .default-date-options-container .default-date-options .btn.btn-tertiary-gray{padding:10px 16px;white-space:nowrap;color:var(--dfm-datepicker-default-date-options-color)}.dfm-datepicker-container .default-date-options-container .default-date-options .btn.btn-tertiary-gray:hover{background-color:var(--dfm-datepicker-default-date-options-bg-hover)}.dfm-datepicker-container .datepicker,.dfm-datepicker-container .datepicker-months{flex-grow:1}.dfm-datepicker-container .datepicker-months .datepicker-month{padding:26px 24px 20px}.dfm-datepicker-container .datepicker-months .datepicker-month.datepicker-month-left{border-right:1px solid var(--dfm-datepicker-border)}.dfm-datepicker-container .datepicker-months .datepicker-month th{font-weight:500;text-align:center;color:var(--dfm-datepicker-month-header-color)}.dfm-datepicker-container .datepicker-months .datepicker-month th,.dfm-datepicker-container .datepicker-months .datepicker-month td{overflow:hidden;width:42px;height:42px}.dfm-datepicker-container .datepicker-months .datepicker-month .datepicker-month-header{padding:6px 8px;margin-bottom:6px}.dfm-datepicker-container .datepicker-months .datepicker-month .datepicker-month-header .month-icon{width:20px;height:20px;cursor:pointer}.dfm-datepicker-container .datepicker-months .datepicker-month .calendar-cell{height:100%;color:var(--dfm-datepicker-cell-color)}.dfm-datepicker-container .datepicker-months .datepicker-month .calendar-cell:hover{font-weight:500;background:var(--dfm-datepicker-cell-bg-hover);color:var(--dfm-datepicker-cell-color-hover);border-radius:50%;cursor:pointer}.dfm-datepicker-container .datepicker-months .datepicker-month .cell-muted{color:var(--dfm-datepicker-cell-color-muted)}.dfm-datepicker-container .datepicker-months .datepicker-month .cell-wrapper-selected{background-color:var(--dfm-datepicker-cell-wrapper-bg-selected);border-radius:50%}.dfm-datepicker-container .datepicker-months .datepicker-month .cell-wrapper-selected-first{border-top-right-radius:0%;border-bottom-right-radius:0%}.dfm-datepicker-container .datepicker-months .datepicker-month .cell-wrapper-selected-second{border-top-left-radius:0%;border-bottom-left-radius:0%}.dfm-datepicker-container .datepicker-months .datepicker-month .cell-wrapper-between-selection{background-color:var(--dfm-datepicker-cell-wrapper-bg-selected);border-right-color:var(--dfm-datepicker-cell-wrapper-bg-selected);border-left-color:var(--dfm-datepicker-cell-wrapper-bg-selected)}.dfm-datepicker-container .datepicker-months .datepicker-month .cell-wrapper-between-selection-right{border-bottom-right-radius:50%;border-top-right-radius:50%}.dfm-datepicker-container .datepicker-months .datepicker-month .cell-wrapper-between-selection-left{border-bottom-left-radius:50%;border-top-left-radius:50%}.dfm-datepicker-container .datepicker-months .datepicker-month .cell-selected{font-weight:500;background:var(--dfm-datepicker-cell-bg-selected);color:var(--dfm-datepicker-cell-color-selected);border-radius:50%}.dfm-datepicker-container .datepicker-months .datepicker-month .cell-between-selection{position:relative;border-radius:0}.dfm-datepicker-container .datepicker-months .datepicker-month .datepicker-input{width:115px}.dfm-datepicker-container .datepicker-months .datepicker-month .cell-today:not(.cell-selected,.calendar-cell:hover,.cell-between-selection,.cell-between-selection-right,.cell-between-selection-left){background-color:var(--dfm-datepicker-cell-bg-today);border-radius:20px;position:relative}.dfm-datepicker-container .datepicker-months .datepicker-month .cell-today:not(.cell-selected,.calendar-cell:hover) .cell-today-dot{position:absolute;left:calc(50% - 2.5px);bottom:4px;width:5px;height:5px;border-radius:50%;background-color:var(--dfm-datepicker-cell-color-today)}.dfm-datepicker-container .actions-bar{border-top:1px solid var(--dfm-datepicker-border);padding:16px;justify-content:space-between;flex-wrap:wrap}.dfm-datepicker-container .actions-bar .actions-bar-inputs{gap:12px;align-items:center}.dfm-datepicker-container .actions-bar .actions-bar-inputs .datepicker-input{width:115px}.dfm-datepicker-container .actions-bar .actions-bar-inputs .datepicker-input-dash{font-style:normal;font-weight:400;font-size:16px;line-height:24px;color:var(--dfm-datepicker-inputs-dash-color)}.dfm-datepicker-container .actions-bar .actions-bar-buttons{gap:12px}@media (max-width: 960px){.dfm-datepicker-container .default-date-options-container{border-right:none;border-bottom:1px solid var(--dfm-datepicker-border)}.dfm-datepicker-container .default-date-options-container .default-date-options{flex-direction:row;flex-wrap:wrap;justify-content:center}.dfm-datepicker-container .datepicker-months .datepicker-month.datepicker-month-left{border-right:none}}@media (max-width: 680px){.dfm-datepicker-container .actions-bar{padding:0}.dfm-datepicker-container .actions-bar .actions-bar-inputs{width:100%;padding:16px}.dfm-datepicker-container .actions-bar .actions-bar-inputs .datepicker-input{flex:1}.dfm-datepicker-container .actions-bar .actions-bar-buttons{width:100%;flex-direction:column;padding:16px 16px 24px;border-top:1px solid var(--dfm-datepicker-border)}}\n"] }]
        }], ctorParameters: function () { return []; }, propDecorators: { datesApplied: [{
                type: Output
            }], cancelled: [{
                type: Output
            }], firstSelectedDate: [{
                type: Input
            }], secondSelectedDate: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0ZXBpY2tlci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9kaWZsZXhtby1hbmd1bGFyLWRlc2lnbi9zcmMvbGliL2Rlc2lnbi1zeXN0ZW0vbW9kdWxlcy9kYXRlcGlja2VyL2RhdGVwaWNrZXIuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvZGlmbGV4bW8tYW5ndWxhci1kZXNpZ24vc3JjL2xpYi9kZXNpZ24tc3lzdGVtL21vZHVsZXMvZGF0ZXBpY2tlci9kYXRlcGlja2VyLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBVSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDL0UsT0FBTyxFQUFFLFdBQVcsRUFBRSxTQUFTLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUV4RCxPQUFPLEVBQUUsR0FBRyxFQUFFLE1BQU0sY0FBYyxDQUFDO0FBQ25DLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxTQUFTLENBQUM7QUFDcEMsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLGVBQWUsQ0FBQzs7Ozs7OztBQU9yQyxNQUFNLE9BQU8sbUJBQW1CO0lBdUM5QjtRQXRDaUIsaUJBQVksR0FBK0IsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUU5RCxjQUFTLEdBQTBCLElBQUksWUFBWSxFQUFFLENBQUM7UUFxQ3JFLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxTQUFTLENBQUM7WUFDN0IsU0FBUyxFQUFFLElBQUksV0FBVyxDQUFjLElBQUksQ0FBQztZQUM3QyxPQUFPLEVBQUUsSUFBSSxXQUFXLENBQWMsSUFBSSxDQUFDO1NBQzVDLENBQUMsQ0FBQztRQUVILElBQUksQ0FBQyxTQUFTLEdBQUcsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsQ0FBQztRQUM3RCxJQUFJLENBQUMsZUFBZSxHQUFHLEVBQUUsQ0FBQztRQUMxQixJQUFJLENBQUMsZ0JBQWdCLEdBQUcsRUFBRSxDQUFDO1FBRTNCLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQztRQUM3QixJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksSUFBSSxFQUFFLENBQUM7SUFDaEMsQ0FBQztJQXBDRCxJQUFXLGlCQUFpQjtRQUMxQixPQUFPLElBQUksQ0FBQyx3QkFBd0IsQ0FBQztJQUN2QyxDQUFDO0lBRUQsSUFBb0IsaUJBQWlCLENBQUMsS0FBdUI7UUFDM0QsSUFBSSxDQUFDLHdCQUF3QixHQUFHLEtBQUssQ0FBQztRQUN0QyxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsQ0FBQyxRQUFRLENBQUMsS0FBSyxJQUFJLElBQUksQ0FBQyxDQUFDO0lBQy9ELENBQUM7SUFJRCxJQUFXLGtCQUFrQjtRQUMzQixPQUFPLElBQUksQ0FBQyx5QkFBeUIsQ0FBQztJQUN4QyxDQUFDO0lBRUQsSUFBb0Isa0JBQWtCLENBQUMsS0FBdUI7UUFDNUQsSUFBSSxDQUFDLHlCQUF5QixHQUFHLEtBQUssQ0FBQztRQUN2QyxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxTQUFTLENBQUMsQ0FBQyxRQUFRLENBQUMsS0FBSyxJQUFJLElBQUksQ0FBQyxDQUFDO0lBQzdELENBQUM7SUFvQk0sUUFBUTtRQUNiLElBQUksQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLElBQUksSUFBSSxFQUFFLENBQUMsUUFBUSxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDckQsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO0lBQ2xCLENBQUM7SUFFTSxRQUFRO1FBQ2IsTUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUN6QyxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQzNDLE1BQU0sZ0JBQWdCLEdBQUcsSUFBSSxJQUFJLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUU1RCxNQUFNLFdBQVcsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQ2hELE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDbEQsTUFBTSxpQkFBaUIsR0FBRyxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBRTdELElBQUksUUFBUSxHQUFHLENBQUMsQ0FBQztRQUNqQixJQUFJLFNBQVMsR0FBRyxDQUFDLENBQUM7UUFDbEIsSUFBSSxnQkFBZ0IsSUFBSSxpQkFBaUIsRUFBRTtZQUN6QyxRQUFRLEdBQUcsbUJBQW1CLENBQUMsdUJBQXVCLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUFDO1lBQ3BFLFNBQVMsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsZ0JBQWdCLEdBQUcsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7U0FDMUQ7YUFBTTtZQUNMLFFBQVEsR0FBRyxtQkFBbUIsQ0FBQyx1QkFBdUIsQ0FBQyxXQUFXLEVBQUUsVUFBVSxDQUFDLENBQUM7WUFDaEYsU0FBUyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxpQkFBaUIsR0FBRyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztTQUMzRDtRQUVELE1BQU0sS0FBSyxHQUFHLFNBQVMsQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDckMsTUFBTSxnQkFBZ0IsR0FBRyxTQUFTLENBQUMsVUFBVSxFQUFFLFdBQVcsQ0FBQyxDQUFDO1FBQzVELElBQUksS0FBSyxHQUFHLGdCQUFnQixFQUFFO1lBQzVCLFNBQVMsR0FBRyxLQUFLLENBQUM7U0FDbkI7YUFBTTtZQUNMLFNBQVMsR0FBRyxnQkFBZ0IsQ0FBQztTQUM5QjtRQUVELElBQUksVUFBVSxHQUFHLENBQUMsQ0FBQztRQUNuQixJQUFJLGdCQUFnQixHQUFHLENBQUMsQ0FBQztRQUN6QixNQUFNLFNBQVMsR0FBRyxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQzNDLE1BQU0sb0JBQW9CLEdBQUcsSUFBSSxJQUFJLENBQUMsSUFBSSxFQUFFLFdBQVcsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUM1RCxJQUFJLENBQUMsZUFBZSxHQUFHLEVBQUUsQ0FBQztRQUMxQixJQUFJLENBQUMsZ0JBQWdCLEdBQUcsRUFBRSxDQUFDO1FBQzNCLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxTQUFTLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFBRTtZQUNyQyxNQUFNLElBQUksR0FBVSxFQUFFLENBQUM7WUFDdkIsTUFBTSxlQUFlLEdBQVUsRUFBRSxDQUFDO1lBRWxDLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFBRTtnQkFDN0IsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFO29CQUNYLElBQUksQ0FBQyxHQUFHLFNBQVMsQ0FBQyxNQUFNLEVBQUUsR0FBRyxDQUFDLEVBQUU7d0JBQzlCLE1BQU0sR0FBRyxHQUFHLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUM7d0JBQ3JDLE1BQU0sU0FBUyxHQUFHLEdBQUcsQ0FBQyxPQUFPLEVBQUUsR0FBRyxDQUFDLFNBQVMsQ0FBQyxNQUFNLEVBQUUsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7d0JBQy9ELEdBQUcsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7d0JBQ3ZCLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztxQkFDekI7eUJBQU07d0JBQ0wsTUFBTSxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRSxVQUFVLENBQUMsQ0FBQzt3QkFDL0MsTUFBTSxjQUFjLEdBQUcsSUFBSSxDQUFDLFFBQVEsRUFBRSxLQUFLLEtBQUssQ0FBQzt3QkFDakQsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLEdBQUcsQ0FBQyxJQUFJLEVBQUUsY0FBYyxDQUFDLENBQUMsQ0FBQzt3QkFDekMsVUFBVSxJQUFJLENBQUMsQ0FBQztxQkFDakI7b0JBQ0QsSUFBSSxDQUFDLEdBQUcsb0JBQW9CLENBQUMsTUFBTSxFQUFFLEdBQUcsQ0FBQyxFQUFFO3dCQUN6QyxNQUFNLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxVQUFVLEVBQUUsV0FBVyxFQUFFLENBQUMsQ0FBQyxDQUFDO3dCQUNsRCxNQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNLEVBQUUsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7d0JBQzVFLElBQUksQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLENBQUM7d0JBQ3pCLGVBQWUsQ0FBQyxJQUFJLENBQUMsSUFBSSxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztxQkFDckM7eUJBQU07d0JBQ0wsZUFBZSxDQUFDLElBQUksQ0FBQyxJQUFJLEdBQUcsQ0FBQyxJQUFJLElBQUksQ0FBQyxVQUFVLEVBQUUsV0FBVyxFQUFFLGdCQUFnQixDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQzt3QkFDekYsZ0JBQWdCLElBQUksQ0FBQyxDQUFDO3FCQUN2QjtpQkFDRjtxQkFBTTtvQkFDTCxNQUFNLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLFVBQVUsQ0FBQyxDQUFDO29CQUMvQyxNQUFNLGNBQWMsR0FBRyxJQUFJLENBQUMsUUFBUSxFQUFFLEtBQUssS0FBSyxDQUFDO29CQUNqRCxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksR0FBRyxDQUFDLElBQUksRUFBRSxjQUFjLENBQUMsQ0FBQyxDQUFDO29CQUN6QyxVQUFVLElBQUksQ0FBQyxDQUFDO29CQUNoQixNQUFNLEtBQUssR0FBRyxJQUFJLElBQUksQ0FBQyxVQUFVLEVBQUUsV0FBVyxFQUFFLGdCQUFnQixDQUFDLENBQUM7b0JBQ2xFLE1BQU0sZUFBZSxHQUFHLEtBQUssQ0FBQyxRQUFRLEVBQUUsS0FBSyxXQUFXLENBQUM7b0JBQ3pELGVBQWUsQ0FBQyxJQUFJLENBQUMsSUFBSSxHQUFHLENBQUMsS0FBSyxFQUFFLGVBQWUsQ0FBQyxDQUFDLENBQUM7b0JBQ3RELGdCQUFnQixJQUFJLENBQUMsQ0FBQztpQkFDdkI7YUFDRjtZQUVELE1BQU0sSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzVCLE1BQU0sS0FBSyxHQUFHLElBQUksSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDO1lBQ3hDLElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2hDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7U0FDbkM7SUFDSCxDQUFDO0lBRU0sTUFBTSxDQUFDLHVCQUF1QixDQUFDLEtBQWEsRUFBRSxJQUFZO1FBQy9ELE1BQU0sR0FBRyxHQUFHLElBQUksSUFBSSxFQUFFLENBQUM7UUFDdkIsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNmLEdBQUcsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDcEIsR0FBRyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUV0QixNQUFNLFFBQVEsR0FBRyxHQUFHLENBQUMsTUFBTSxFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQ2xDLE9BQU8sUUFBUSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDO0lBQ2pELENBQUM7SUFFTSxjQUFjLENBQUMsSUFBVTtRQUM5QixPQUFPLElBQUksQ0FBQyxpQkFBaUIsRUFBRSxPQUFPLEVBQUUsS0FBSyxJQUFJLENBQUMsT0FBTyxFQUFFLElBQUksSUFBSSxDQUFDLGtCQUFrQixFQUFFLE9BQU8sRUFBRSxLQUFLLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQztJQUN2SCxDQUFDO0lBRU0sa0JBQWtCLENBQUMsSUFBVTtRQUNsQyxJQUFJLENBQUMsSUFBSSxDQUFDLGlCQUFpQixJQUFJLENBQUMsSUFBSSxDQUFDLGtCQUFrQixJQUFJLENBQUMsSUFBSSxFQUFFO1lBQ2hFLE9BQU8sS0FBSyxDQUFDO1NBQ2Q7UUFFRCxPQUFPLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLElBQUksSUFBSSxDQUFDLGtCQUFrQixHQUFHLElBQUksQ0FBQztJQUN6RSxDQUFDO0lBRU0sVUFBVSxDQUFDLElBQVU7UUFDMUIsSUFBSSxDQUFDLElBQUksRUFBRTtZQUNULE9BQU87U0FDUjtRQUVELElBQUksSUFBSSxDQUFDLGtCQUFrQixJQUFJLElBQUksS0FBSyxJQUFJLENBQUMsa0JBQWtCLEVBQUU7WUFDL0QsSUFBSSxDQUFDLGtCQUFrQixHQUFHLFNBQVMsQ0FBQztZQUNwQyxPQUFPO1NBQ1I7UUFFRCxJQUFJLElBQUksQ0FBQyxpQkFBaUIsSUFBSSxJQUFJLENBQUMsaUJBQWlCLEtBQUssSUFBSSxFQUFFO1lBQzdELElBQUksQ0FBQyxpQkFBaUIsR0FBRyxTQUFTLENBQUM7WUFDbkMsSUFBSSxJQUFJLENBQUMsa0JBQWtCLEVBQUU7Z0JBQzNCLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLENBQUMsa0JBQWtCLENBQUM7Z0JBQ2pELElBQUksQ0FBQyxrQkFBa0IsR0FBRyxTQUFTLENBQUM7YUFDckM7WUFDRCxPQUFPO1NBQ1I7UUFFRCxJQUFJLENBQUMsSUFBSSxDQUFDLGlCQUFpQixFQUFFO1lBQzNCLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLENBQUM7U0FDL0I7UUFFRCxJQUFJLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLEVBQUU7WUFDakMsSUFBSSxDQUFDLElBQUksQ0FBQyxrQkFBa0IsRUFBRTtnQkFDNUIsSUFBSSxDQUFDLGtCQUFrQixHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQzthQUNsRDtZQUNELElBQUksQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLENBQUM7U0FDL0I7UUFFRCxJQUFJLElBQUksR0FBRyxJQUFJLENBQUMsaUJBQWlCLEVBQUU7WUFDakMsSUFBSSxDQUFDLGtCQUFrQixHQUFHLElBQUksQ0FBQztTQUNoQztJQUNILENBQUM7SUFFTSxNQUFNO1FBQ1gsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDNUIsQ0FBQztJQUVNLEtBQUs7UUFDVixNQUFNLElBQUksR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDO1FBQ3hCLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDMUIsSUFBSSxDQUFDLGlCQUFpQixHQUFHLElBQUksQ0FBQztRQUM5QixJQUFJLENBQUMsa0JBQWtCLEdBQUcsSUFBSSxDQUFDO1FBQy9CLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztJQUM5RCxDQUFDO0lBRU0sU0FBUztRQUNkLE1BQU0sSUFBSSxHQUFHLElBQUksSUFBSSxFQUFFLENBQUM7UUFDeEIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUMxQixJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUNqQyxJQUFJLENBQUMsaUJBQWlCLEdBQUcsSUFBSSxDQUFDO1FBQzlCLElBQUksQ0FBQyxrQkFBa0IsR0FBRyxJQUFJLENBQUM7UUFDL0IsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsRUFBRSxTQUFTLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO0lBQzlELENBQUM7SUFFTSxTQUFTO1FBQ2QsTUFBTSxJQUFJLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQztRQUN4QixJQUFJLENBQUMsaUJBQWlCLEdBQUcsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUMxRSxJQUFJLENBQUMsa0JBQWtCLEdBQUcsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQUUsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDL0UsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsRUFBRSxTQUFTLEVBQUUsSUFBSSxDQUFDLGlCQUFpQixFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsa0JBQWtCLEVBQUUsQ0FBQyxDQUFDO0lBQ25HLENBQUM7SUFFTSxTQUFTO1FBQ2QsTUFBTSxJQUFJLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQztRQUN4QixJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUNuQyxJQUFJLENBQUMsaUJBQWlCLEdBQUcsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUMxRSxJQUFJLENBQUMsa0JBQWtCLEdBQUcsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQUUsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDL0UsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsRUFBRSxTQUFTLEVBQUUsSUFBSSxDQUFDLGlCQUFpQixFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsa0JBQWtCLEVBQUUsQ0FBQyxDQUFDO0lBQ25HLENBQUM7SUFFTSxRQUFRO1FBQ2IsTUFBTSxJQUFJLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQztRQUN4QixJQUFJLENBQUMsaUJBQWlCLEdBQUcsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUM1RCxJQUFJLENBQUMsa0JBQWtCLEdBQUcsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDakUsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsRUFBRSxTQUFTLEVBQUUsSUFBSSxDQUFDLGlCQUFpQixFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsa0JBQWtCLEVBQUUsQ0FBQyxDQUFDO0lBQ25HLENBQUM7SUFFTSxRQUFRO1FBQ2IsTUFBTSxJQUFJLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQztRQUN4QixJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUN6QyxJQUFJLENBQUMsaUJBQWlCLEdBQUcsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUM1RCxJQUFJLENBQUMsa0JBQWtCLEdBQUcsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDakUsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsRUFBRSxTQUFTLEVBQUUsSUFBSSxDQUFDLGlCQUFpQixFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsa0JBQWtCLEVBQUUsQ0FBQyxDQUFDO0lBQ25HLENBQUM7SUFFTSxrQkFBa0I7UUFDdkIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUN6RCxJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUM1QyxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7SUFDbEIsQ0FBQztJQUVNLGNBQWM7UUFDbkIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUN6RCxJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUU1QyxJQUFJLElBQUksQ0FBQyxVQUFVLENBQUMsUUFBUSxFQUFFLEtBQUssSUFBSSxDQUFDLFdBQVcsQ0FBQyxRQUFRLEVBQUUsRUFBRTtZQUM5RCxJQUFJLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLFFBQVEsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDO1lBQzNELElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1NBQy9DO1FBRUQsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO0lBQ2xCLENBQUM7SUFFTSxtQkFBbUI7UUFDeEIsSUFBSSxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxRQUFRLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUMzRCxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUU5QyxJQUFJLElBQUksQ0FBQyxVQUFVLENBQUMsUUFBUSxFQUFFLEtBQUssSUFBSSxDQUFDLFdBQVcsQ0FBQyxRQUFRLEVBQUUsRUFBRTtZQUM5RCxJQUFJLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLFFBQVEsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDO1lBQ3pELElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1NBQzdDO1FBRUQsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO0lBQ2xCLENBQUM7SUFFTSxlQUFlO1FBQ3BCLElBQUksQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsUUFBUSxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDM0QsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDOUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO0lBQ2xCLENBQUM7SUFFTSxVQUFVO1FBQ2YsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsRUFBRSxTQUFTLEVBQUUsSUFBSSxDQUFDLGlCQUFpQixFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsa0JBQWtCLEVBQUUsQ0FBQyxDQUFDO0lBQ25HLENBQUM7SUFFTSxpQkFBaUI7UUFDdEIsTUFBTSxxQkFBcUIsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsQ0FBQyxLQUFLLENBQUM7UUFFekUsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLHFCQUFxQixDQUFDLEVBQUU7WUFDdEMsSUFBSSxJQUFJLENBQUMsa0JBQWtCLElBQUkscUJBQXFCLEdBQUcsSUFBSSxDQUFDLGtCQUFrQixFQUFFO2dCQUM5RSxJQUFJLENBQUMsaUJBQWlCLEdBQUcsSUFBSSxDQUFDLGtCQUFrQixDQUFDO2dCQUNqRCxJQUFJLENBQUMsa0JBQWtCLEdBQUcscUJBQXFCLENBQUM7YUFDakQ7aUJBQU07Z0JBQ0wsSUFBSSxDQUFDLGlCQUFpQixHQUFHLHFCQUFxQixDQUFDO2FBQ2hEO1NBQ0Y7YUFBTTtZQUNMLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLENBQUMsd0JBQXdCLENBQUM7U0FDeEQ7SUFDSCxDQUFDO0lBRU0sZUFBZTtRQUNwQixNQUFNLG1CQUFtQixHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxDQUFDLEtBQUssQ0FBQztRQUVyRSxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsbUJBQW1CLENBQUMsRUFBRTtZQUNwQyxJQUFJLElBQUksQ0FBQyxpQkFBaUIsSUFBSSxtQkFBbUIsR0FBRyxJQUFJLENBQUMsaUJBQWlCLEVBQUU7Z0JBQzFFLElBQUksQ0FBQyxrQkFBa0IsR0FBRyxJQUFJLENBQUMsaUJBQWlCLENBQUM7Z0JBQ2pELElBQUksQ0FBQyxpQkFBaUIsR0FBRyxtQkFBbUIsQ0FBQzthQUM5QztpQkFBTTtnQkFDTCxJQUFJLENBQUMsa0JBQWtCLEdBQUcsbUJBQW1CLENBQUM7YUFDL0M7U0FDRjthQUFNO1lBQ0wsSUFBSSxDQUFDLGtCQUFrQixHQUFHLElBQUksQ0FBQyx3QkFBd0IsQ0FBQztTQUN6RDtJQUNILENBQUM7SUFFTSxPQUFPLENBQUMsS0FBYSxFQUFFLElBQVU7UUFDdEMsTUFBTSxLQUFLLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQztRQUV6QixPQUFPLENBQ0wsS0FBSyxLQUFLLElBQUksQ0FBQyxRQUFRLEVBQUU7WUFDekIsSUFBSSxDQUFDLE9BQU8sRUFBRSxLQUFLLEtBQUssQ0FBQyxPQUFPLEVBQUU7WUFDbEMsSUFBSSxDQUFDLFFBQVEsRUFBRSxLQUFLLEtBQUssQ0FBQyxRQUFRLEVBQUU7WUFDcEMsSUFBSSxDQUFDLFdBQVcsRUFBRSxLQUFLLEtBQUssQ0FBQyxXQUFXLEVBQUUsQ0FDM0MsQ0FBQztJQUNKLENBQUM7SUFFTyxNQUFNLENBQUMsSUFBUztRQUN0QixPQUFPLElBQUksWUFBWSxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDO0lBQy9ELENBQUM7O2lIQXZVVSxtQkFBbUI7cUdBQW5CLG1CQUFtQix1TkNaaEMsaTFKQStGQTs0RkRuRmEsbUJBQW1CO2tCQUwvQixTQUFTOytCQUNFLGdCQUFnQjswRUFLVCxZQUFZO3NCQUE1QixNQUFNO2dCQUVVLFNBQVM7c0JBQXpCLE1BQU07Z0JBZ0JhLGlCQUFpQjtzQkFBcEMsS0FBSztnQkFXYyxrQkFBa0I7c0JBQXJDLEtBQUsiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIEV2ZW50RW1pdHRlciwgSW5wdXQsIE9uSW5pdCwgT3V0cHV0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBGb3JtQ29udHJvbCwgRm9ybUdyb3VwIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuaW1wb3J0IHsgQXBwbGllZERhdGVzIH0gZnJvbSAnLi9tb2RlbHMvYXBwbGllZC1kYXRlcyc7XG5pbXBvcnQgeyBEYXkgfSBmcm9tICcuL21vZGVscy9kYXknO1xuaW1wb3J0IHsgd2Vla0NvdW50IH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgeyBXZWVrIH0gZnJvbSAnLi9tb2RlbHMvd2Vlayc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2RmbS1kYXRlcGlja2VyJyxcbiAgdGVtcGxhdGVVcmw6ICcuL2RhdGVwaWNrZXIuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9kYXRlcGlja2VyLmNvbXBvbmVudC5zY3NzJ10sXG59KVxuZXhwb3J0IGNsYXNzIERhdGVwaWNrZXJDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuICBAT3V0cHV0KCkgcHVibGljIGRhdGVzQXBwbGllZDogRXZlbnRFbWl0dGVyPEFwcGxpZWREYXRlcz4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgQE91dHB1dCgpIHB1YmxpYyBjYW5jZWxsZWQ6IEV2ZW50RW1pdHRlcjxib29sZWFuPiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcblxuICBwdWJsaWMgZmlyc3RNb250aDogRGF0ZTtcblxuICBwdWJsaWMgc2Vjb25kTW9udGg6IERhdGU7XG5cbiAgcHVibGljIGZpcnN0TW9udGhXZWVrczogV2Vla1tdO1xuXG4gIHB1YmxpYyBzZWNvbmRNb250aFdlZWtzOiBXZWVrW107XG5cbiAgcHJpdmF0ZSBwcml2YXRlRmlyc3RTZWxlY3RlZERhdGU6IERhdGUgfCB1bmRlZmluZWQ7XG5cbiAgcHVibGljIGdldCBmaXJzdFNlbGVjdGVkRGF0ZSgpOiBEYXRlIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5wcml2YXRlRmlyc3RTZWxlY3RlZERhdGU7XG4gIH1cblxuICBASW5wdXQoKSBwdWJsaWMgc2V0IGZpcnN0U2VsZWN0ZWREYXRlKHZhbHVlOiBEYXRlIHwgdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5wcml2YXRlRmlyc3RTZWxlY3RlZERhdGUgPSB2YWx1ZTtcbiAgICB0aGlzLmRhdGVSYW5nZS5jb250cm9sc1snc3RhcnREYXRlJ10uc2V0VmFsdWUodmFsdWUgfHwgbnVsbCk7XG4gIH1cblxuICBwcml2YXRlIHByaXZhdGVTZWNvbmRTZWxlY3RlZERhdGU6IERhdGUgfCB1bmRlZmluZWQ7XG5cbiAgcHVibGljIGdldCBzZWNvbmRTZWxlY3RlZERhdGUoKTogRGF0ZSB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMucHJpdmF0ZVNlY29uZFNlbGVjdGVkRGF0ZTtcbiAgfVxuXG4gIEBJbnB1dCgpIHB1YmxpYyBzZXQgc2Vjb25kU2VsZWN0ZWREYXRlKHZhbHVlOiBEYXRlIHwgdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5wcml2YXRlU2Vjb25kU2VsZWN0ZWREYXRlID0gdmFsdWU7XG4gICAgdGhpcy5kYXRlUmFuZ2UuY29udHJvbHNbJ2VuZERhdGUnXS5zZXRWYWx1ZSh2YWx1ZSB8fCBudWxsKTtcbiAgfVxuXG4gIHB1YmxpYyBkYXRlUmFuZ2U6IEZvcm1Hcm91cDtcblxuICBwdWJsaWMgd2Vla05hbWVzOiBzdHJpbmdbXTtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmRhdGVSYW5nZSA9IG5ldyBGb3JtR3JvdXAoe1xuICAgICAgc3RhcnREYXRlOiBuZXcgRm9ybUNvbnRyb2w8RGF0ZSB8IG51bGw+KG51bGwpLFxuICAgICAgZW5kRGF0ZTogbmV3IEZvcm1Db250cm9sPERhdGUgfCBudWxsPihudWxsKSxcbiAgICB9KTtcblxuICAgIHRoaXMud2Vla05hbWVzID0gWydNbycsICdUdScsICdXZScsICdUaCcsICdGcicsICdTYXQnLCAnU3UnXTtcbiAgICB0aGlzLmZpcnN0TW9udGhXZWVrcyA9IFtdO1xuICAgIHRoaXMuc2Vjb25kTW9udGhXZWVrcyA9IFtdO1xuXG4gICAgdGhpcy5maXJzdE1vbnRoID0gbmV3IERhdGUoKTtcbiAgICB0aGlzLnNlY29uZE1vbnRoID0gbmV3IERhdGUoKTtcbiAgfVxuXG4gIHB1YmxpYyBuZ09uSW5pdCgpOiB2b2lkIHtcbiAgICB0aGlzLnNlY29uZE1vbnRoLnNldE1vbnRoKG5ldyBEYXRlKCkuZ2V0TW9udGgoKSArIDEpO1xuICAgIHRoaXMuc2V0V2Vla3MoKTtcbiAgfVxuXG4gIHB1YmxpYyBzZXRXZWVrcygpIHtcbiAgICBjb25zdCBtb250aCA9IHRoaXMuZmlyc3RNb250aC5nZXRNb250aCgpO1xuICAgIGNvbnN0IHllYXIgPSB0aGlzLmZpcnN0TW9udGguZ2V0RnVsbFllYXIoKTtcbiAgICBjb25zdCBkYXlzSW5GaXJzdE1vbnRoID0gbmV3IERhdGUoeWVhciwgbW9udGgsIDApLmdldERhdGUoKTtcblxuICAgIGNvbnN0IHNlY29uZE1vbnRoID0gdGhpcy5zZWNvbmRNb250aC5nZXRNb250aCgpO1xuICAgIGNvbnN0IHNlY29uZFllYXIgPSB0aGlzLnNlY29uZE1vbnRoLmdldEZ1bGxZZWFyKCk7XG4gICAgY29uc3QgZGF5c0luU2Vjb25kTW9udGggPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCwgMCkuZ2V0RGF0ZSgpO1xuXG4gICAgbGV0IGZpcnN0RGF5ID0gMDtcbiAgICBsZXQgbW9udGhSb3dzID0gMDtcbiAgICBpZiAoZGF5c0luRmlyc3RNb250aCA+PSBkYXlzSW5TZWNvbmRNb250aCkge1xuICAgICAgZmlyc3REYXkgPSBEYXRlcGlja2VyQ29tcG9uZW50LmdldEZpcnN0RGF5T2ZNb250aEluZGV4KG1vbnRoLCB5ZWFyKTtcbiAgICAgIG1vbnRoUm93cyA9IE1hdGguY2VpbCgoZGF5c0luRmlyc3RNb250aCArIGZpcnN0RGF5KSAvIDcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBmaXJzdERheSA9IERhdGVwaWNrZXJDb21wb25lbnQuZ2V0Rmlyc3REYXlPZk1vbnRoSW5kZXgoc2Vjb25kTW9udGgsIHNlY29uZFllYXIpO1xuICAgICAgbW9udGhSb3dzID0gTWF0aC5jZWlsKChkYXlzSW5TZWNvbmRNb250aCArIGZpcnN0RGF5KSAvIDcpO1xuICAgIH1cblxuICAgIGNvbnN0IHdlZWtzID0gd2Vla0NvdW50KHllYXIsIG1vbnRoKTtcbiAgICBjb25zdCB3ZWVrc1NlY29uZE1vbnRoID0gd2Vla0NvdW50KHNlY29uZFllYXIsIHNlY29uZE1vbnRoKTtcbiAgICBpZiAod2Vla3MgPiB3ZWVrc1NlY29uZE1vbnRoKSB7XG4gICAgICBtb250aFJvd3MgPSB3ZWVrcztcbiAgICB9IGVsc2Uge1xuICAgICAgbW9udGhSb3dzID0gd2Vla3NTZWNvbmRNb250aDtcbiAgICB9XG5cbiAgICBsZXQgZGF5SW5Nb250aCA9IDE7XG4gICAgbGV0IGRheUluU2Vjb25kTW9udGggPSAxO1xuICAgIGNvbnN0IGZpcnN0RGF0ZSA9IG5ldyBEYXRlKHllYXIsIG1vbnRoLCAxKTtcbiAgICBjb25zdCBmaXJzdERhdGVTZWNvbmRNb250aCA9IG5ldyBEYXRlKHllYXIsIHNlY29uZE1vbnRoLCAxKTtcbiAgICB0aGlzLmZpcnN0TW9udGhXZWVrcyA9IFtdO1xuICAgIHRoaXMuc2Vjb25kTW9udGhXZWVrcyA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbW9udGhSb3dzOyBpICs9IDEpIHtcbiAgICAgIGNvbnN0IGRheXM6IERheVtdID0gW107XG4gICAgICBjb25zdCBzZWNvbmRNb250aERheXM6IERheVtdID0gW107XG5cbiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgNzsgaiArPSAxKSB7XG4gICAgICAgIGlmIChpID09PSAwKSB7XG4gICAgICAgICAgaWYgKGogPCBmaXJzdERhdGUuZ2V0RGF5KCkgLSAxKSB7XG4gICAgICAgICAgICBjb25zdCBkYXkgPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCwgMCk7XG4gICAgICAgICAgICBjb25zdCBkYXlOdW1iZXIgPSBkYXkuZ2V0RGF0ZSgpIC0gKGZpcnN0RGF0ZS5nZXREYXkoKSAtIDIgLSBqKTtcbiAgICAgICAgICAgIGRheS5zZXREYXRlKGRheU51bWJlcik7XG4gICAgICAgICAgICBkYXlzLnB1c2gobmV3IERheShkYXkpKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHllYXIsIG1vbnRoLCBkYXlJbk1vbnRoKTtcbiAgICAgICAgICAgIGNvbnN0IGlzQ3VycmVudE1vbnRoID0gZGF0ZS5nZXRNb250aCgpID09PSBtb250aDtcbiAgICAgICAgICAgIGRheXMucHVzaChuZXcgRGF5KGRhdGUsIGlzQ3VycmVudE1vbnRoKSk7XG4gICAgICAgICAgICBkYXlJbk1vbnRoICs9IDE7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChqIDwgZmlyc3REYXRlU2Vjb25kTW9udGguZ2V0RGF5KCkgLSAxKSB7XG4gICAgICAgICAgICBjb25zdCBkYXkyID0gbmV3IERhdGUoc2Vjb25kWWVhciwgc2Vjb25kTW9udGgsIDApO1xuICAgICAgICAgICAgY29uc3QgZGF5Mk51bWJlciA9IGRheTIuZ2V0RGF0ZSgpIC0gKGZpcnN0RGF0ZVNlY29uZE1vbnRoLmdldERheSgpIC0gMiAtIGopO1xuICAgICAgICAgICAgZGF5Mi5zZXREYXRlKGRheTJOdW1iZXIpO1xuICAgICAgICAgICAgc2Vjb25kTW9udGhEYXlzLnB1c2gobmV3IERheShkYXkyKSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNlY29uZE1vbnRoRGF5cy5wdXNoKG5ldyBEYXkobmV3IERhdGUoc2Vjb25kWWVhciwgc2Vjb25kTW9udGgsIGRheUluU2Vjb25kTW9udGgpLCB0cnVlKSk7XG4gICAgICAgICAgICBkYXlJblNlY29uZE1vbnRoICs9IDE7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCwgZGF5SW5Nb250aCk7XG4gICAgICAgICAgY29uc3QgaXNDdXJyZW50TW9udGggPSBkYXRlLmdldE1vbnRoKCkgPT09IG1vbnRoO1xuICAgICAgICAgIGRheXMucHVzaChuZXcgRGF5KGRhdGUsIGlzQ3VycmVudE1vbnRoKSk7XG4gICAgICAgICAgZGF5SW5Nb250aCArPSAxO1xuICAgICAgICAgIGNvbnN0IGRhdGUyID0gbmV3IERhdGUoc2Vjb25kWWVhciwgc2Vjb25kTW9udGgsIGRheUluU2Vjb25kTW9udGgpO1xuICAgICAgICAgIGNvbnN0IGlzQ3VycmVudE1vbnRoMiA9IGRhdGUyLmdldE1vbnRoKCkgPT09IHNlY29uZE1vbnRoO1xuICAgICAgICAgIHNlY29uZE1vbnRoRGF5cy5wdXNoKG5ldyBEYXkoZGF0ZTIsIGlzQ3VycmVudE1vbnRoMikpO1xuICAgICAgICAgIGRheUluU2Vjb25kTW9udGggKz0gMTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjb25zdCB3ZWVrID0gbmV3IFdlZWsoZGF5cyk7XG4gICAgICBjb25zdCB3ZWVrMiA9IG5ldyBXZWVrKHNlY29uZE1vbnRoRGF5cyk7XG4gICAgICB0aGlzLmZpcnN0TW9udGhXZWVrcy5wdXNoKHdlZWspO1xuICAgICAgdGhpcy5zZWNvbmRNb250aFdlZWtzLnB1c2god2VlazIpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgZ2V0Rmlyc3REYXlPZk1vbnRoSW5kZXgobW9udGg6IG51bWJlciwgeWVhcjogbnVtYmVyKTogbnVtYmVyIHtcbiAgICBjb25zdCBkYXkgPSBuZXcgRGF0ZSgpO1xuICAgIGRheS5zZXREYXRlKDEpO1xuICAgIGRheS5zZXRNb250aChtb250aCk7XG4gICAgZGF5LnNldEZ1bGxZZWFyKHllYXIpO1xuXG4gICAgY29uc3QgZGF5SW5kZXggPSBkYXkuZ2V0RGF5KCkgKyA3O1xuICAgIHJldHVybiBkYXlJbmRleCA+PSA3ID8gZGF5SW5kZXggLSA3IDogZGF5SW5kZXg7XG4gIH1cblxuICBwdWJsaWMgaXNTZWxlY3RlZERhdGUoZGF0ZTogRGF0ZSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmZpcnN0U2VsZWN0ZWREYXRlPy5nZXRUaW1lKCkgPT09IGRhdGUuZ2V0VGltZSgpIHx8IHRoaXMuc2Vjb25kU2VsZWN0ZWREYXRlPy5nZXRUaW1lKCkgPT09IGRhdGUuZ2V0VGltZSgpO1xuICB9XG5cbiAgcHVibGljIGlzQmV0d2VlblNlbGVjdGlvbihkYXRlOiBEYXRlKTogYm9vbGVhbiB7XG4gICAgaWYgKCF0aGlzLmZpcnN0U2VsZWN0ZWREYXRlIHx8ICF0aGlzLnNlY29uZFNlbGVjdGVkRGF0ZSB8fCAhZGF0ZSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmZpcnN0U2VsZWN0ZWREYXRlIDwgZGF0ZSAmJiB0aGlzLnNlY29uZFNlbGVjdGVkRGF0ZSA+IGRhdGU7XG4gIH1cblxuICBwdWJsaWMgc2VsZWN0RGF0ZShkYXRlOiBEYXRlKTogdm9pZCB7XG4gICAgaWYgKCFkYXRlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuc2Vjb25kU2VsZWN0ZWREYXRlICYmIGRhdGUgPT09IHRoaXMuc2Vjb25kU2VsZWN0ZWREYXRlKSB7XG4gICAgICB0aGlzLnNlY29uZFNlbGVjdGVkRGF0ZSA9IHVuZGVmaW5lZDtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5maXJzdFNlbGVjdGVkRGF0ZSAmJiB0aGlzLmZpcnN0U2VsZWN0ZWREYXRlID09PSBkYXRlKSB7XG4gICAgICB0aGlzLmZpcnN0U2VsZWN0ZWREYXRlID0gdW5kZWZpbmVkO1xuICAgICAgaWYgKHRoaXMuc2Vjb25kU2VsZWN0ZWREYXRlKSB7XG4gICAgICAgIHRoaXMuZmlyc3RTZWxlY3RlZERhdGUgPSB0aGlzLnNlY29uZFNlbGVjdGVkRGF0ZTtcbiAgICAgICAgdGhpcy5zZWNvbmRTZWxlY3RlZERhdGUgPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmZpcnN0U2VsZWN0ZWREYXRlKSB7XG4gICAgICB0aGlzLmZpcnN0U2VsZWN0ZWREYXRlID0gZGF0ZTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5maXJzdFNlbGVjdGVkRGF0ZSA+IGRhdGUpIHtcbiAgICAgIGlmICghdGhpcy5zZWNvbmRTZWxlY3RlZERhdGUpIHtcbiAgICAgICAgdGhpcy5zZWNvbmRTZWxlY3RlZERhdGUgPSB0aGlzLmZpcnN0U2VsZWN0ZWREYXRlO1xuICAgICAgfVxuICAgICAgdGhpcy5maXJzdFNlbGVjdGVkRGF0ZSA9IGRhdGU7XG4gICAgfVxuXG4gICAgaWYgKGRhdGUgPiB0aGlzLmZpcnN0U2VsZWN0ZWREYXRlKSB7XG4gICAgICB0aGlzLnNlY29uZFNlbGVjdGVkRGF0ZSA9IGRhdGU7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIGNhbmNlbCgpOiB2b2lkIHtcbiAgICB0aGlzLmNhbmNlbGxlZC5uZXh0KHRydWUpO1xuICB9XG5cbiAgcHVibGljIHRvZGF5KCk6IHZvaWQge1xuICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgIGRhdGUuc2V0SG91cnMoMCwgMCwgMCwgMCk7XG4gICAgdGhpcy5maXJzdFNlbGVjdGVkRGF0ZSA9IGRhdGU7XG4gICAgdGhpcy5zZWNvbmRTZWxlY3RlZERhdGUgPSBkYXRlO1xuICAgIHRoaXMuZGF0ZXNBcHBsaWVkLm5leHQoeyBzdGFydERhdGU6IGRhdGUsIHN0b3BEYXRlOiBkYXRlIH0pO1xuICB9XG5cbiAgcHVibGljIHllc3RlcmRheSgpOiB2b2lkIHtcbiAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoKTtcbiAgICBkYXRlLnNldEhvdXJzKDAsIDAsIDAsIDApO1xuICAgIGRhdGUuc2V0RGF0ZShkYXRlLmdldERhdGUoKSAtIDEpO1xuICAgIHRoaXMuZmlyc3RTZWxlY3RlZERhdGUgPSBkYXRlO1xuICAgIHRoaXMuc2Vjb25kU2VsZWN0ZWREYXRlID0gZGF0ZTtcbiAgICB0aGlzLmRhdGVzQXBwbGllZC5uZXh0KHsgc3RhcnREYXRlOiBkYXRlLCBzdG9wRGF0ZTogZGF0ZSB9KTtcbiAgfVxuXG4gIHB1YmxpYyB0aGlzTW9udGgoKTogdm9pZCB7XG4gICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgdGhpcy5maXJzdFNlbGVjdGVkRGF0ZSA9IG5ldyBEYXRlKGRhdGUuZ2V0RnVsbFllYXIoKSwgZGF0ZS5nZXRNb250aCgpLCAxKTtcbiAgICB0aGlzLnNlY29uZFNlbGVjdGVkRGF0ZSA9IG5ldyBEYXRlKGRhdGUuZ2V0RnVsbFllYXIoKSwgZGF0ZS5nZXRNb250aCgpICsgMSwgMCk7XG4gICAgdGhpcy5kYXRlc0FwcGxpZWQubmV4dCh7IHN0YXJ0RGF0ZTogdGhpcy5maXJzdFNlbGVjdGVkRGF0ZSwgc3RvcERhdGU6IHRoaXMuc2Vjb25kU2VsZWN0ZWREYXRlIH0pO1xuICB9XG5cbiAgcHVibGljIGxhc3RNb250aCgpOiB2b2lkIHtcbiAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoKTtcbiAgICBkYXRlLnNldE1vbnRoKGRhdGUuZ2V0TW9udGgoKSAtIDEpO1xuICAgIHRoaXMuZmlyc3RTZWxlY3RlZERhdGUgPSBuZXcgRGF0ZShkYXRlLmdldEZ1bGxZZWFyKCksIGRhdGUuZ2V0TW9udGgoKSwgMSk7XG4gICAgdGhpcy5zZWNvbmRTZWxlY3RlZERhdGUgPSBuZXcgRGF0ZShkYXRlLmdldEZ1bGxZZWFyKCksIGRhdGUuZ2V0TW9udGgoKSArIDEsIDApO1xuICAgIHRoaXMuZGF0ZXNBcHBsaWVkLm5leHQoeyBzdGFydERhdGU6IHRoaXMuZmlyc3RTZWxlY3RlZERhdGUsIHN0b3BEYXRlOiB0aGlzLnNlY29uZFNlbGVjdGVkRGF0ZSB9KTtcbiAgfVxuXG4gIHB1YmxpYyB0aGlzWWVhcigpOiB2b2lkIHtcbiAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoKTtcbiAgICB0aGlzLmZpcnN0U2VsZWN0ZWREYXRlID0gbmV3IERhdGUoZGF0ZS5nZXRGdWxsWWVhcigpLCAwLCAxKTtcbiAgICB0aGlzLnNlY29uZFNlbGVjdGVkRGF0ZSA9IG5ldyBEYXRlKGRhdGUuZ2V0RnVsbFllYXIoKSArIDEsIDAsIDApO1xuICAgIHRoaXMuZGF0ZXNBcHBsaWVkLm5leHQoeyBzdGFydERhdGU6IHRoaXMuZmlyc3RTZWxlY3RlZERhdGUsIHN0b3BEYXRlOiB0aGlzLnNlY29uZFNlbGVjdGVkRGF0ZSB9KTtcbiAgfVxuXG4gIHB1YmxpYyBsYXN0WWVhcigpOiB2b2lkIHtcbiAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoKTtcbiAgICBkYXRlLnNldEZ1bGxZZWFyKGRhdGUuZ2V0RnVsbFllYXIoKSAtIDEpO1xuICAgIHRoaXMuZmlyc3RTZWxlY3RlZERhdGUgPSBuZXcgRGF0ZShkYXRlLmdldEZ1bGxZZWFyKCksIDAsIDEpO1xuICAgIHRoaXMuc2Vjb25kU2VsZWN0ZWREYXRlID0gbmV3IERhdGUoZGF0ZS5nZXRGdWxsWWVhcigpICsgMSwgMCwgMCk7XG4gICAgdGhpcy5kYXRlc0FwcGxpZWQubmV4dCh7IHN0YXJ0RGF0ZTogdGhpcy5maXJzdFNlbGVjdGVkRGF0ZSwgc3RvcERhdGU6IHRoaXMuc2Vjb25kU2VsZWN0ZWREYXRlIH0pO1xuICB9XG5cbiAgcHVibGljIGZpcnN0TW9udGhQcmV2aW91cygpOiB2b2lkIHtcbiAgICB0aGlzLmZpcnN0TW9udGguc2V0TW9udGgodGhpcy5maXJzdE1vbnRoLmdldE1vbnRoKCkgLSAxKTtcbiAgICB0aGlzLmZpcnN0TW9udGggPSBuZXcgRGF0ZSh0aGlzLmZpcnN0TW9udGgpO1xuICAgIHRoaXMuc2V0V2Vla3MoKTtcbiAgfVxuXG4gIHB1YmxpYyBmaXJzdE1vbnRoTmV4dCgpOiB2b2lkIHtcbiAgICB0aGlzLmZpcnN0TW9udGguc2V0TW9udGgodGhpcy5maXJzdE1vbnRoLmdldE1vbnRoKCkgKyAxKTtcbiAgICB0aGlzLmZpcnN0TW9udGggPSBuZXcgRGF0ZSh0aGlzLmZpcnN0TW9udGgpO1xuXG4gICAgaWYgKHRoaXMuZmlyc3RNb250aC5nZXRNb250aCgpID09PSB0aGlzLnNlY29uZE1vbnRoLmdldE1vbnRoKCkpIHtcbiAgICAgIHRoaXMuc2Vjb25kTW9udGguc2V0TW9udGgodGhpcy5zZWNvbmRNb250aC5nZXRNb250aCgpICsgMSk7XG4gICAgICB0aGlzLnNlY29uZE1vbnRoID0gbmV3IERhdGUodGhpcy5zZWNvbmRNb250aCk7XG4gICAgfVxuXG4gICAgdGhpcy5zZXRXZWVrcygpO1xuICB9XG5cbiAgcHVibGljIHNlY29uZE1vbnRoUHJldmlvdXMoKTogdm9pZCB7XG4gICAgdGhpcy5zZWNvbmRNb250aC5zZXRNb250aCh0aGlzLnNlY29uZE1vbnRoLmdldE1vbnRoKCkgLSAxKTtcbiAgICB0aGlzLnNlY29uZE1vbnRoID0gbmV3IERhdGUodGhpcy5zZWNvbmRNb250aCk7XG5cbiAgICBpZiAodGhpcy5maXJzdE1vbnRoLmdldE1vbnRoKCkgPT09IHRoaXMuc2Vjb25kTW9udGguZ2V0TW9udGgoKSkge1xuICAgICAgdGhpcy5maXJzdE1vbnRoLnNldE1vbnRoKHRoaXMuZmlyc3RNb250aC5nZXRNb250aCgpIC0gMSk7XG4gICAgICB0aGlzLmZpcnN0TW9udGggPSBuZXcgRGF0ZSh0aGlzLmZpcnN0TW9udGgpO1xuICAgIH1cblxuICAgIHRoaXMuc2V0V2Vla3MoKTtcbiAgfVxuXG4gIHB1YmxpYyBzZWNvbmRNb250aE5leHQoKTogdm9pZCB7XG4gICAgdGhpcy5zZWNvbmRNb250aC5zZXRNb250aCh0aGlzLnNlY29uZE1vbnRoLmdldE1vbnRoKCkgKyAxKTtcbiAgICB0aGlzLnNlY29uZE1vbnRoID0gbmV3IERhdGUodGhpcy5zZWNvbmRNb250aCk7XG4gICAgdGhpcy5zZXRXZWVrcygpO1xuICB9XG5cbiAgcHVibGljIGFwcGx5RGF0ZXMoKTogdm9pZCB7XG4gICAgdGhpcy5kYXRlc0FwcGxpZWQubmV4dCh7IHN0YXJ0RGF0ZTogdGhpcy5maXJzdFNlbGVjdGVkRGF0ZSwgc3RvcERhdGU6IHRoaXMuc2Vjb25kU2VsZWN0ZWREYXRlIH0pO1xuICB9XG5cbiAgcHVibGljIHN0YXJ0RGF0ZUZvY3VzT3V0KCk6IHZvaWQge1xuICAgIGNvbnN0IHN0YXJ0RGF0ZUNvbnRyb2xWYWx1ZSA9IHRoaXMuZGF0ZVJhbmdlLmNvbnRyb2xzWydzdGFydERhdGUnXS52YWx1ZTtcblxuICAgIGlmICh0aGlzLmlzRGF0ZShzdGFydERhdGVDb250cm9sVmFsdWUpKSB7XG4gICAgICBpZiAodGhpcy5zZWNvbmRTZWxlY3RlZERhdGUgJiYgc3RhcnREYXRlQ29udHJvbFZhbHVlID4gdGhpcy5zZWNvbmRTZWxlY3RlZERhdGUpIHtcbiAgICAgICAgdGhpcy5maXJzdFNlbGVjdGVkRGF0ZSA9IHRoaXMuc2Vjb25kU2VsZWN0ZWREYXRlO1xuICAgICAgICB0aGlzLnNlY29uZFNlbGVjdGVkRGF0ZSA9IHN0YXJ0RGF0ZUNvbnRyb2xWYWx1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuZmlyc3RTZWxlY3RlZERhdGUgPSBzdGFydERhdGVDb250cm9sVmFsdWU7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZmlyc3RTZWxlY3RlZERhdGUgPSB0aGlzLnByaXZhdGVGaXJzdFNlbGVjdGVkRGF0ZTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgZW5kRGF0ZUZvY3VzT3V0KCk6IHZvaWQge1xuICAgIGNvbnN0IGVuZERhdGVDb250cm9sVmFsdWUgPSB0aGlzLmRhdGVSYW5nZS5jb250cm9sc1snZW5kRGF0ZSddLnZhbHVlO1xuXG4gICAgaWYgKHRoaXMuaXNEYXRlKGVuZERhdGVDb250cm9sVmFsdWUpKSB7XG4gICAgICBpZiAodGhpcy5maXJzdFNlbGVjdGVkRGF0ZSAmJiBlbmREYXRlQ29udHJvbFZhbHVlIDwgdGhpcy5maXJzdFNlbGVjdGVkRGF0ZSkge1xuICAgICAgICB0aGlzLnNlY29uZFNlbGVjdGVkRGF0ZSA9IHRoaXMuZmlyc3RTZWxlY3RlZERhdGU7XG4gICAgICAgIHRoaXMuZmlyc3RTZWxlY3RlZERhdGUgPSBlbmREYXRlQ29udHJvbFZhbHVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5zZWNvbmRTZWxlY3RlZERhdGUgPSBlbmREYXRlQ29udHJvbFZhbHVlO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNlY29uZFNlbGVjdGVkRGF0ZSA9IHRoaXMucHJpdmF0ZUZpcnN0U2VsZWN0ZWREYXRlO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBpc1RvZGF5KG1vbnRoOiBudW1iZXIsIGRhdGU6IERhdGUpOiBib29sZWFuIHtcbiAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCk7XG5cbiAgICByZXR1cm4gKFxuICAgICAgbW9udGggPT09IGRhdGUuZ2V0TW9udGgoKSAmJlxuICAgICAgZGF0ZS5nZXREYXRlKCkgPT09IHRvZGF5LmdldERhdGUoKSAmJlxuICAgICAgZGF0ZS5nZXRNb250aCgpID09PSB0b2RheS5nZXRNb250aCgpICYmXG4gICAgICBkYXRlLmdldEZ1bGxZZWFyKCkgPT09IHRvZGF5LmdldEZ1bGxZZWFyKClcbiAgICApO1xuICB9XG5cbiAgcHJpdmF0ZSBpc0RhdGUoZGF0ZTogYW55KTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIGRhdGUgaW5zdGFuY2VvZiBEYXRlICYmICFOdW1iZXIuaXNOYU4oZGF0ZS5nZXRUaW1lKCkpO1xuICB9XG59XG4iLCI8ZGl2IGNsYXNzPVwiZGZtLWRhdGVwaWNrZXItY29udGFpbmVyIGQtZmxleFwiPlxuICA8ZGl2IGNsYXNzPVwiZGVmYXVsdC1kYXRlLW9wdGlvbnMtY29udGFpbmVyIGQtZmxleCBqdXN0aWZ5LWNvbnRlbnQtY2VudGVyXCI+XG4gICAgPGRpdiBjbGFzcz1cImRlZmF1bHQtZGF0ZS1vcHRpb25zXCI+XG4gICAgICA8YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi10ZXJ0aWFyeS1ncmF5XCIgKGNsaWNrKT1cInRvZGF5KClcIj5Ub2RheTwvYnV0dG9uPlxuICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tdGVydGlhcnktZ3JheVwiIChjbGljayk9XCJ5ZXN0ZXJkYXkoKVwiPlllc3RlcmRheTwvYnV0dG9uPlxuICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tdGVydGlhcnktZ3JheVwiIChjbGljayk9XCJ0aGlzTW9udGgoKVwiPlRoaXMgbW9udGg8L2J1dHRvbj5cbiAgICAgIDxidXR0b24gY2xhc3M9XCJidG4gYnRuLXRlcnRpYXJ5LWdyYXlcIiAoY2xpY2spPVwibGFzdE1vbnRoKClcIj5MYXN0IG1vbnRoPC9idXR0b24+XG4gICAgICA8YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi10ZXJ0aWFyeS1ncmF5XCIgKGNsaWNrKT1cInRoaXNZZWFyKClcIj5UaGlzIHllYXI8L2J1dHRvbj5cbiAgICAgIDxidXR0b24gY2xhc3M9XCJidG4gYnRuLXRlcnRpYXJ5LWdyYXlcIiAoY2xpY2spPVwibGFzdFllYXIoKVwiPkxhc3QgeWVhcjwvYnV0dG9uPlxuICAgIDwvZGl2PlxuICA8L2Rpdj5cbiAgPGRpdiBjbGFzcz1cImRhdGVwaWNrZXIgZC1mbGV4IGZsZXgtY29sdW1uXCI+XG4gICAgPGRpdiBjbGFzcz1cImRhdGVwaWNrZXItbW9udGhzIGQtZmxleCBmbGV4LXdyYXAganVzdGlmeS1jb250ZW50LWNlbnRlclwiPlxuICAgICAgPGRpdiBjbGFzcz1cImRhdGVwaWNrZXItbW9udGggZGF0ZXBpY2tlci1tb250aC1sZWZ0XCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJkYXRlcGlja2VyLW1vbnRoLWhlYWRlciBkLWZsZXgganVzdGlmeS1jb250ZW50LWJldHdlZW4gYWxpZ24taXRlbXMtY2VudGVyXCI+XG4gICAgICAgICAgPGRmbS1pY29uIG5hbWU9XCJjaGV2cm9uLWxlZnRcIiBjbGFzcz1cIm1vbnRoLWljb24gZGZtLXRleHQtbWFpbi01MDBcIiAoY2xpY2spPVwiZmlyc3RNb250aFByZXZpb3VzKClcIj48L2RmbS1pY29uPlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJteS1hdXRvIHRleHQtbWQtbWVkaXVtXCI+XG4gICAgICAgICAgICB7eyBmaXJzdE1vbnRoIHwgZGF0ZTogJ01NTU0geXl5eScgfX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8ZGZtLWljb24gbmFtZT1cImNoZXZyb24tcmlnaHRcIiBjbGFzcz1cIm1vbnRoLWljb24gZGZtLXRleHQtbWFpbi01MDBcIiAoY2xpY2spPVwiZmlyc3RNb250aE5leHQoKVwiPjwvZGZtLWljb24+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8bmctY29udGFpbmVyICpuZ1RlbXBsYXRlT3V0bGV0PVwibW9udGhWaWV3OyBjb250ZXh0OiB7IHdlZWtzOiBmaXJzdE1vbnRoV2Vla3MgfVwiPjwvbmctY29udGFpbmVyPlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzPVwiZGF0ZXBpY2tlci1tb250aFwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiZGF0ZXBpY2tlci1tb250aC1oZWFkZXIgZC1mbGV4IGp1c3RpZnktY29udGVudC1iZXR3ZWVuIGFsaWduLWl0ZW1zLWNlbnRlclwiPlxuICAgICAgICAgIDxkZm0taWNvbiBuYW1lPVwiY2hldnJvbi1sZWZ0XCIgY2xhc3M9XCJtb250aC1pY29uIGRmbS10ZXh0LW1haW4tNTAwXCIgKGNsaWNrKT1cInNlY29uZE1vbnRoUHJldmlvdXMoKVwiPjwvZGZtLWljb24+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cIm15LWF1dG8gdGV4dC1tZC1tZWRpdW1cIj5cbiAgICAgICAgICAgIHt7IHNlY29uZE1vbnRoIHwgZGF0ZTogJ01NTU0geXl5eScgfX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8ZGZtLWljb24gbmFtZT1cImNoZXZyb24tcmlnaHRcIiBjbGFzcz1cIm1vbnRoLWljb24gZGZtLXRleHQtbWFpbi01MDBcIiAoY2xpY2spPVwic2Vjb25kTW9udGhOZXh0KClcIj48L2RmbS1pY29uPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cIm1vbnRoVmlldzsgY29udGV4dDogeyB3ZWVrczogc2Vjb25kTW9udGhXZWVrcyB9XCI+PC9uZy1jb250YWluZXI+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgICA8Zm9ybSBbZm9ybUdyb3VwXT1cImRhdGVSYW5nZVwiPlxuICAgICAgPGRpdiBjbGFzcz1cImFjdGlvbnMtYmFyIGQtZmxleCBhbGlnbi1pdGVtcy1jZW50ZXJcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImQtZmxleCBhY3Rpb25zLWJhci1pbnB1dHNcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiZGF0ZXBpY2tlci1pbnB1dFwiPlxuICAgICAgICAgICAgPGRmbS1pbnB1dCBmb3JtQ29udHJvbE5hbWU9XCJzdGFydERhdGVcIiB0eXBlPVwiZGF0ZXBpY2tlclwiIHBsYWNlaG9sZGVyPVwiU3RhcnQgRGF0ZVwiIChmb2N1c291dCk9XCJzdGFydERhdGVGb2N1c091dCgpXCI+PC9kZm0taW5wdXQ+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cInRleHQtY2VudGVyXCI+XG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cImRhdGVwaWNrZXItaW5wdXQtZGFzaCBteS1hdXRvXCI+LTwvc3Bhbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiZGF0ZXBpY2tlci1pbnB1dFwiPlxuICAgICAgICAgICAgPGRmbS1pbnB1dCBmb3JtQ29udHJvbE5hbWU9XCJlbmREYXRlXCIgdHlwZT1cImRhdGVwaWNrZXJcIiBwbGFjZWhvbGRlcj1cIkVuZCBEYXRlXCIgKGZvY3Vzb3V0KT1cImVuZERhdGVGb2N1c091dCgpXCI+PC9kZm0taW5wdXQ+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPVwiZC1mbGV4IGFjdGlvbnMtYmFyLWJ1dHRvbnNcIj5cbiAgICAgICAgICA8ZGZtLWJ1dHRvbiBjb2xvcj1cInNlY29uZGFyeVwiIHNpemU9XCJtZFwiIChjbGljayk9XCJjYW5jZWwoKVwiPkNhbmNlbDwvZGZtLWJ1dHRvbj5cbiAgICAgICAgICA8ZGZtLWJ1dHRvbiBzaXplPVwibWRcIiAoY2xpY2spPVwiYXBwbHlEYXRlcygpXCI+QXBwbHkgZGF0ZXM8L2RmbS1idXR0b24+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgPC9mb3JtPlxuICA8L2Rpdj5cbjwvZGl2PlxuXG48bmctdGVtcGxhdGUgI21vbnRoVmlldyBsZXQtd2Vla3M9XCJ3ZWVrc1wiPlxuICA8dGFibGU+XG4gICAgPHRoZWFkPlxuICAgICAgPHRyPlxuICAgICAgICA8dGggKm5nRm9yPVwibGV0IHdlZWtOYW1lIG9mIHdlZWtOYW1lc1wiPnt7IHdlZWtOYW1lIH19PC90aD5cbiAgICAgIDwvdHI+XG4gICAgPC90aGVhZD5cbiAgICA8dGJvZHk+XG4gICAgICA8dHIgKm5nRm9yPVwibGV0IHdlZWsgb2Ygd2Vla3NcIj5cbiAgICAgICAgPHRkXG4gICAgICAgICAgY2xhc3M9XCJ0ZXh0LWNlbnRlclwiXG4gICAgICAgICAgW25nQ2xhc3NdPVwie1xuICAgICAgICAgICAgJ2NlbGwtd3JhcHBlci1zZWxlY3RlZCc6IGlzU2VsZWN0ZWREYXRlKGRheS5kYXRlKSAmJiBmaXJzdFNlbGVjdGVkRGF0ZSAmJiBzZWNvbmRTZWxlY3RlZERhdGUsXG4gICAgICAgICAgICAnY2VsbC13cmFwcGVyLXNlbGVjdGVkLWZpcnN0JzogZmlyc3RTZWxlY3RlZERhdGUgJiYgc2Vjb25kU2VsZWN0ZWREYXRlICYmIGZpcnN0U2VsZWN0ZWREYXRlLmdldFRpbWUoKSAhPT0gc2Vjb25kU2VsZWN0ZWREYXRlLmdldFRpbWUoKSxcbiAgICAgICAgICAgICdjZWxsLXdyYXBwZXItc2VsZWN0ZWQtc2Vjb25kJzogZmlyc3RTZWxlY3RlZERhdGUgJiYgc2Vjb25kU2VsZWN0ZWREYXRlICYmIGZpcnN0U2VsZWN0ZWREYXRlLmdldFRpbWUoKSAhPT0gc2Vjb25kU2VsZWN0ZWREYXRlLmdldFRpbWUoKSxcbiAgICAgICAgICAgICdjZWxsLXdyYXBwZXItYmV0d2Vlbi1zZWxlY3Rpb24nOiBpc0JldHdlZW5TZWxlY3Rpb24oZGF5LmRhdGUpLFxuICAgICAgICAgICAgJ2NlbGwtd3JhcHBlci1iZXR3ZWVuLXNlbGVjdGlvbi1yaWdodCc6IGlzQmV0d2VlblNlbGVjdGlvbihkYXkuZGF0ZSkgJiYgaSA9PT0gNixcbiAgICAgICAgICAgICdjZWxsLXdyYXBwZXItYmV0d2Vlbi1zZWxlY3Rpb24tbGVmdCc6IGlzQmV0d2VlblNlbGVjdGlvbihkYXkuZGF0ZSkgJiYgaSA9PT0gMFxuICAgICAgICAgIH1cIlxuICAgICAgICAgICpuZ0Zvcj1cImxldCBkYXkgb2Ygd2Vlay5kYXlzOyBpbmRleCBhcyBpXCJcbiAgICAgICAgICAoY2xpY2spPVwic2VsZWN0RGF0ZShkYXkuZGF0ZSlcIlxuICAgICAgICA+XG4gICAgICAgICAgPGRpdlxuICAgICAgICAgICAgY2xhc3M9XCJjYWxlbmRhci1jZWxsIGQtZmxleCBqdXN0aWZ5LWNvbnRlbnQtY2VudGVyIGFsaWduLWl0ZW1zLWNlbnRlclwiXG4gICAgICAgICAgICBbbmdDbGFzc109XCJ7XG4gICAgICAgICAgICAgICdjZWxsLXNlbGVjdGVkJzogaXNTZWxlY3RlZERhdGUoZGF5LmRhdGUpLFxuICAgICAgICAgICAgICAnY2VsbC1iZXR3ZWVuLXNlbGVjdGlvbic6IGlzQmV0d2VlblNlbGVjdGlvbihkYXkuZGF0ZSkgJiYgaSAhPT0gNiAmJiBpICE9PSAwLFxuICAgICAgICAgICAgICAnY2VsbC1tdXRlZCc6ICFkYXkuaXNDdXJyZW50TW9udGgsXG4gICAgICAgICAgICAgICdjZWxsLXRvZGF5JzogaXNUb2RheShmaXJzdE1vbnRoLmdldE1vbnRoKCksIGRheS5kYXRlKVxuICAgICAgICAgICAgfVwiXG4gICAgICAgICAgPlxuICAgICAgICAgICAge3sgZGF5LmRhdGUuZ2V0RGF0ZSgpIH19XG4gICAgICAgICAgICA8c3BhbiAqbmdJZj1cImlzVG9kYXkoZmlyc3RNb250aC5nZXRNb250aCgpLCBkYXkuZGF0ZSlcIiBjbGFzcz1cImNlbGwtdG9kYXktZG90XCI+PC9zcGFuPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L3RkPlxuICAgICAgPC90cj5cbiAgICA8L3Rib2R5PlxuICA8L3RhYmxlPlxuPC9uZy10ZW1wbGF0ZT5cbiJdfQ==